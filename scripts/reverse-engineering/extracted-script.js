!function(){"use strict";function e(e,t){return t.forEach(function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach(function(i){if("default"!==i&&!(i in e)){var r=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(e,i,r.get?r:{enumerable:!0,get:function(){return t[i]}})}})}),Object.freeze(e)}class t{constructor(e="adcsh",t=!1){this.tagName=e,this.isDebugEnabled=t,(t=localStorage.getItem("adcsh_dbg"))&&(this.isDebugEnabled=JSON.parse(t))}#e(e,t){this.isDebugEnabled&&console.log(`[${this.tagName}][${e}]:`,...t)}debug(...e){this.#e("debug",e)}error(...e){this.#e("error",e)}}class i{isCapped=!1;hasNoInventory=!1;show(){throw new Error("not implemented")}}const r=(e,t,i)=>e.addEventListener?e.addEventListener(t,i):e.attachEvent(`on${t}`,i),n=(e,t,i)=>{if(e.removeEventListener)return e.removeEventListener(t,i);e.detachEvent(`on${t}`,i)},s=async(e,t=!1)=>"undefined"!=typeof navigator&&"userAgentData"in navigator?navigator.userAgentData.getHighEntropyValues(["model","platform","platformVersion","uaFullVersion"]).then(e=>{const i={};if(e.hasOwnProperty("brands")&&e.brands.length>0){const t=[];for(let i=0;i<e.brands.length;i+=1){const r=e.brands[i];t.push(`"${r.brand}";v=${r.version}`)}i.chu=encodeURIComponent(t.join(", "))}e.hasOwnProperty("mobile")&&(i.chmob=encodeURIComponent(e.mobile?"?1":"?0"));const r={model:"chmod",platform:"chp",platformVersion:"chpv",uaFullVersion:"chuafv"};for(const t in r)e.hasOwnProperty(t)&&e[t]&&(i[r[t]]=encodeURIComponent(e[t]));if(t)return i;let n="";for(let e in i)n+=`&${e}=${i[e]}`;return n}).catch(t=>(e.error("error getting client hints:",t),"")):t?{}:"",o=()=>{let e=window.location.href;return a()&&(e=document.referrer),l(e)},a=()=>{try{return window.self!==window.top?1:0}catch(e){return 1}},l=e=>{let t=Math.max(e.indexOf(" ",256),e.indexOf(",",256));return(t>384||t<20)&&(t=256),e.substring(0,t)},d=()=>{if(void 0===window.rgxngibqxq||""===window.rgxngibqxq){let e=[],t="0123456789abcdefghijklmnopqrstuvwxyz";for(let i=0;i<32;i++)e[i]=t.substr(Math.floor(16*Math.random()),1);e[14]="4",e[19]=t.substr(3&e[19]|8,1),window.rgxngibqxq=e.join("")}return window.rgxngibqxq},c=()=>window.innerWidth||document.body.clientWidth,h=()=>window.innerHeight||document.body.clientHeight,u=()=>{let e=document.title;if(a())try{e=window.top.document.title}catch(t){e=""}return l(e)},g=()=>{var e=document.referrer;if(a())try{e=window.top.document.referrer}catch(t){e=""}return l(e)},p=(e,t=null)=>{try{const t=window.top.document.getElementsByTagName("meta");for(let i=0;i<t.length;i++)if(t[i].hasAttribute("name")&&t[i].getAttribute("name").toLowerCase()===e){const e=t[i].getAttribute("content");return l(e)}}catch(e){t&&t.error(e)}return""},m=/opera/i.test(navigator.userAgent),f=(/msie/i.test(navigator.userAgent)||/Trident/i.test(navigator.userAgent))&&!m,b=/chrome|crios/i.test(navigator.userAgent),v=/firefox/i.test(navigator.userAgent),y=(navigator.userAgent.match(/.+(?:ox|me|ra|ie|Edge)[\/: ]([\d.]+)/)||[])[1],w=parseInt(y),T=/android/i.test(navigator.userAgent),A=/ipad|ipod|iphone/i.test(navigator.userAgent),k=/blackberry/i.test(navigator.userAgent)||/BB10/i.test(navigator.userAgent),E=/iemobile/i.test(navigator.userAgent)||/(?=.*\bWindows\b)(?=.*\bARM\b)/i.test(navigator.userAgent)||/Windows Phone/i.test(navigator.userAgent),C=/opera mini/i.test(navigator.userAgent)||/opios/i.test(navigator.userAgent),S=/^((?!UCWEB).)*UCBrowser.*Mobile.+/i.test(navigator.userAgent),I=/(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)/i.test(navigator.userAgent),x=/(KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA|JSS15J|Silk|Kindle)/i.test(navigator.userAgent),R=/fban\/fbios|fbav|fbios|fb_iab\/fb4a/i.test(navigator.userAgent),N=T||A||k||E||C||S||I||x||R,L=/pinterest\/(ios|android)/i.test(navigator.userAgent),O=(e,t=1,i=15)=>((e,t)=>{let i="";for(let r=0;r<t;r++)i+=e[Math.floor(Math.random()*e.length)];return i})(e,Math.floor(Math.random()*(i-t+1))+t),D=e=>{if((e=new URL(e)).search){const t=O("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",24,24),i=e.searchParams.entries(),r=Array.from(i);(e=>{for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}})(r);const n=r.map(e=>`${e[0]}=${encodeURIComponent(e[1])}`).join("&"),s=encodeURIComponent(btoa(n));e.search=`${t}=${s}`}return e.toString()},P=()=>`${navigator.platform}/${navigator.appCodeName}/${navigator.appName}/${navigator.cookieEnabled}/${navigator.javaEnabled()}/${navigator.vendor}`+Math.max(window.screen.width,window.screen.height)+"x"+Math.min(window.screen.width,window.screen.height)+(new Date).getTimezoneOffset()+navigator.language+(navigator.deviceMemory||"unknown")+navigator.hardwareConcurrency+screen.pixelDepth+" bits",U=(()=>{try{return!0===new Request("",{keepalive:!0}).keepalive}catch(e){return!1}})(),$=e=>JSON.parse(atob(e)),V=e=>{if(e.s){const t=$(e.s);return delete e.s,{...e,...t}}return["hp","hIpp","hInt"].forEach(t=>{e[t]&&(e[t]=$(e[t]))}),e},M=e=>new Promise(t=>{setTimeout(t,e)}),F="interstitial",q="pop",z="tabswap",B="utsid-send",H=(e,t,i,r,n)=>{const s=document.createElement("div");s.id="modal",s.style.position="fixed",s.style.top="5vh",s.style.left="50%",s.style.transform="translate(-50%)",s.style.maxWidth="95%",s.style.display="flex",s.style.flexDirection="column",s.style.alignItems="center",s.style.overflow="hidden",s.style.padding="10px",s.style.borderRadius="6px",s.style.backgroundColor="rgba(0, 0, 0, 0.6)",s.style.zIndex="2147483644",s.style.boxShadow="0 4px 8px rgba(0,0,0,0.2)",s.setAttribute("doskip","1"),s.setAttribute("prclck","1");const o=document.createElement("div");o.id="buttonContainer",o.style.display="block",o.style.margin="0",o.style.width="100%",o.style.textAlign="center",o.style.padding="0",o.style.height="36px",o.style.fontSize="16px",o.style.fontFamily='OpenSans-Semibold, Arial, "Helvetica Neue", Helvetica, sans-serif';const a=document.createElement("a");a.id="goToButton",a.style.float="left",a.style.borderRadius="4px",a.style.fontSize="12px",a.style.background="rgb(0, 0, 0)",a.style.opacity="1",a.style.textDecoration="none",a.style.color="rgb(255, 255, 255)",a.style.padding="10px 20px",a.style.cursor="pointer",a.style.display="inline-block",a.textContent=e,a.href=t,a.target="_blank",a.rel="noopener noreferrer";const l=document.createElement("div");l.id="closeButton",l.style.float="right",l.style.borderRadius="4px",l.style.fontSize="12px",l.style.background="rgb(0, 0, 0)",l.style.opacity="1",l.style.textDecoration="none",l.style.color="rgb(255, 255, 255)",l.style.padding="10px 20px",l.style.cursor="pointer",l.style.display="inline-block",l.textContent=i;const d=document.createElement("div");d.id="content",d.style.marginTop="10px",d.style.maxWidth="100%";const c=document.createElement("img");return c.id="impImg",c.style.display="none",c.width="0",c.height="0",c.src=n,o.appendChild(a),o.appendChild(l),s.appendChild(o),d.appendChild(r),s.appendChild(d),s.appendChild(c),s},_=e=>{const t=document.createElement("iframe");function i(){const e=window.innerWidth;e<=600?(t.style.width="90vw",t.style.height="70vh"):e>600&&e<=1024?(t.style.width="80vw",t.style.height="70vh"):(t.style.width="60vw",t.style.height="70vh")}return t.id="creative_iframe",t.setAttribute("allowfullscreen",""),t.setAttribute("frameborder","0"),t.setAttribute("doskip","1"),t.setAttribute("prclck","1"),t.setAttribute("sandbox","allow-same-origin allow-scripts allow-popups allow-forms"),t.setAttribute("referrerpolicy","no-referrer"),t.src=e,t.style.margin="0",t.style.padding="0",t.style.border="0",i(),window.addEventListener("resize",i),{content:t,resizeFunc:i}},W=(e,t,i,r)=>{const n=document.createElement("a");n.id="a_click_link",n.href=e,n.rel="noopener noreferrer",n.target="_blank",n.style.display="block";const s=document.createElement("img");function o(){window.innerWidth/window.innerHeight>=1?(s.style.height="75vh",s.style.width="auto"):(s.style.height="auto",s.style.width="90vw")}return s.id="creative_image",s.src=t,s.alt="",s.setAttribute("referrerpolicy","no-referrer"),s.style.maxWidth=i+"px",s.style.maxHeight=r+"px",s.style.width="90vw",n.appendChild(s),o(),window.addEventListener("resize",o),{content:n,resizeFunc:o}},j=e=>{const t=document.createElement("iframe");function i(){const e=window.innerWidth;e<=600?(t.style.maxWidth="90vw",t.style.height="70vh"):e>600&&e<=1024?(t.style.maxWidth="80vw",t.style.height="70vh"):(t.style.maxWidth="60vw",t.style.minHeight="40vh")}return t.id="creative_iframe",t.setAttribute("allowfullscreen",""),t.setAttribute("frameborder","0"),t.setAttribute("doskip","1"),t.setAttribute("sandbox","allow-same-origin allow-scripts allow-popups allow-forms"),t.setAttribute("referrerpolicy","no-referrer"),t.setAttribute("rel","noopener noreferrer"),t.setAttribute(e,"1"),t.style.margin="0",t.style.padding="0",t.style.border="0",i(),window.addEventListener("resize",i),{content:t,resizeFunc:i}},G=(e,t,i,r,n)=>{const s=document.createElement("div");s.id="modal",s.style.textAlign="left",s.style.width="100%",s.style.height="100%",s.style.position="fixed",s.style.inset="0",s.style.zIndex="2147483646",s.style.backgroundColor="rgba(0,0,0,0.8)",s.setAttribute("doskip","1"),s.setAttribute("prclck","1");const o=document.createElement("div");o.id="buttonContainer",o.style.display="block",o.style.textAlign="center",o.style.padding="0",o.style.height="36px",o.style.fontSize="16px",o.style.fontFamily='OpenSans-Semibold, Arial, "Helvetica Neue", Helvetica, sans-serif',o.style.margin="6px 15px";const a=document.createElement("a");a.id="goToButton",a.style.float="left",a.style.borderRadius="4px",a.style.fontSize="16px",a.style.background="rgb(0, 0, 0)",a.style.textDecoration="none",a.style.color="rgb(255, 255, 255)",a.style.padding="10px 20px",a.style.cursor="pointer",a.style.display="inline-block",a.textContent=e,a.href=t,a.target="_blank",a.rel="noopener noreferrer";const l=document.createElement("div");l.id="closeButton",l.style.float="right",l.style.borderRadius="4px",l.style.fontSize="16px",l.style.background="rgb(0, 0, 0)",l.style.textDecoration="none",l.style.color="rgb(255, 255, 255)",l.style.padding="10px 20px",l.style.cursor="pointer",l.style.display="inline-block",l.textContent=i;const d=document.createElement("div");d.id="content",d.style.marginTop="10px",d.style.display="flex",d.style.justifyContent="center",d.style.width="100%",d.style.height="100%";const c=document.createElement("img");return c.id="impImg",c.style.display="none",c.width="0",c.height="0",c.src=n,o.appendChild(a),o.appendChild(l),s.appendChild(o),d.appendChild(r),s.appendChild(d),s.appendChild(c),s},Z=e=>{const t=document.createElement("iframe");return t.id="creative_iframe",t.setAttribute("allowfullscreen",""),t.setAttribute("frameborder","0"),t.setAttribute("doskip","1"),t.setAttribute("prclck","1"),t.setAttribute("sandbox","allow-same-origin allow-scripts allow-popups allow-forms"),t.setAttribute("referrerpolicy","no-referrer"),t.src=e,t.style.margin="0",t.style.padding="0",t.style.border="0",t.style.width="100%",t.style.height="100%",{content:t,resizeFunc:null}},K=(e,t,i,r)=>{const n=document.createElement("a");n.id="a_click_link",n.href=e,n.rel="noopener noreferrer",n.target="_blank",n.style.display="block";const s=document.createElement("img");function o(){window.innerWidth>window.innerHeight?(s.style.width="auto",s.style.height="75vh"):(s.style.width="95vw",s.style.height="auto")}return s.id="creative_image",s.src=t,s.alt="",s.setAttribute("referrerpolicy","no-referrer"),s.style.maxWidth=i+"px",s.style.maxHeight=r+"px",s.style.width="95vw",n.appendChild(s),o(),window.addEventListener("resize",o),{content:n,resizeFunc:o}},Q=e=>{const t=document.createElement("iframe");return t.id="creative_iframe",t.setAttribute("allowfullscreen",""),t.setAttribute("frameborder","0"),t.setAttribute("doskip","1"),t.setAttribute("sandbox","allow-same-origin allow-scripts allow-popups allow-forms"),t.setAttribute("referrerpolicy","no-referrer"),t.setAttribute("rel","noopener noreferrer"),t.setAttribute(e,"1"),t.style.margin="0",t.style.padding="0",t.style.border="0",t.style.width="100%",t.style.height="100%",{content:t,resizeFunc:null}},X="utsid-send",Y=2147483647,J="dontfoid",ee="donto",te="znid",ie="prclck";let re=class{#t={};#i=null;#r=0;#n;#s;#o;constructor(e,t,i,r,n){this.#t=e,this.#i=i,this.#r=0,this.#n=t,this.#s=r,this.#o=n}render(e){let t=null;switch(e.type){case 1:this.#i.debug(`rendering INTERSTITIAL IFRAME (type 1) in ${this.#t.isOverlay?"OVERLAY":"FULLSCREEN"} mode`),t=this.#t.isOverlay?_(e.url):Z(e.url);break;case 3:this.#i.debug(`rendering INTERSTITIAL IMAGE (type 3) in ${this.#t.isOverlay?"OVERLAY":"FULLSCREEN"} mode`),t=this.#t.isOverlay?W(e.url,e.ad.url,e.ad.width,e.ad.height):K(e.url,e.ad.url,e.ad.width,e.ad.height);break;case 4:if(e.isHtmlTemplate)return this.#i.debug("rendering INTERSTITIAL HTML CUSTOM (type 4)"),void this.#a(e);this.#i.debug(`rendering INTERSTITIAL HTML (type 4) in ${this.#t.isOverlay?"OVERLAY":"FULLSCREEN"} mode`),t=this.#t.isOverlay?j(ie):Q(ie);break;default:return void this.#i.error(`no such type of interstitial: ${e.type}`)}const i=document.createElement("div");document.body.appendChild(i);const r=i.attachShadow({mode:"open"}),n=this.#t.isOverlay?H:G;if(r.appendChild(n(this.#t.texts.goToButton,e.url,this.#l(),t.content,e.iurl)),4===e.type){const t=r.getElementById("creative_iframe");t.contentWindow.contents=e.html,t.src='javascript:window["contents"]'}if(!this.#t.disableCountdown&&this.#t.moveTimerInsideButtonAfter>0){this.#r=this.#t.moveTimerInsideButtonAfter,r.getElementById("closeButton").innerHTML=this.#l();const e=setInterval(()=>{this.#r--,r.getElementById("closeButton").innerHTML=this.#l(),0===this.#r&&clearInterval(e)},1e3)}r.getElementById("closeButton").addEventListener("click",()=>{this.#r>0||(this.#i.debug("close button click. remove modal host, resize listener if present and do callback"),i.remove(),t.resizeFunc&&window.removeEventListener("resize",t.resizeFunc),this.#n(F))})}#l(){let e=`${this.#t.texts.pleaseWait}: ${this.#r} ${this.#t.texts.timePlural}`;return 1===this.#r&&(e=`${this.#t.texts.pleaseWait}: ${this.#r} ${this.#t.texts.timeSingle}`),0===this.#r&&(e=this.#t.disableCountdown?this.#t.texts.xLabel:this.#t.texts.skipAd),e}#a(e){const t=(new DOMParser).parseFromString(e.html,"text/html").querySelector("script"),i=document.createElement("script");i.style.zIndex="2147483646",t.src?i.setAttribute("src",t.src):i.innerText=t.innerText;const s=()=>{this.#i.debug("CT-CLICK"),fetch(e.link,{mode:"no-cors"}),n(document,"ct-click",s)},a=()=>{this.#i.debug("CT-CLOSE"),n(document,"ct-click",s),n(document,"ct-close",a),document.body.removeChild(i),this.#n(F)};r(document,"ct-click",s),r(document,"ct-close",a);let l=e.iurl;window[X]&&(l+=`&utsid=${window[X]}`),l+=`&cbpage=${encodeURIComponent(o())}`,l+=`&cbref=${encodeURIComponent(g())}`,i.onload=async()=>{try{await fetch(l.toString())}catch(e){return this.#i.debug(e),void(this.#o&&!this.#s.isAdbMode()&&(this.#i.debug("imp failed: try alt domain and path"),this.#s.enableAdbMode()))}document.dispatchEvent(new CustomEvent("impression-event"))},i.onerror=()=>{this.#i.debug("custom html script failed to load"),this.#n(F)},document.body.appendChild(i)}},ne=class extends i{#d;#c;#h;#u;#g;#p;#m;#n;#f;#b;#s;#i;#v=!1;#t={};isCapped=!1;hasNoInventory=!1;#y=null;#o;#w=12;#T="71.2";#A=null;#k=!1;#E=!1;#C;constructor(e){super(),this.#i=new t(`atag_${e.collectiveZoneId}_interstitial_${e.zoneId}`),this.#i.debug("init atag interstitial with config:",e),this.#d=e.zoneId,this.#c=e.isFullscreen,this.#o=e.adblockSettings,this.#h=e.collectiveZoneId,this.#u=e.aggressivity,this.#g=e.recordPageView,this.#p=e.adsCapping,this.#m=e.abTest,this.#g=e.recordPageView,this.#n=e.actionCallback,this.#f=e.adserverDomain,this.#s=window[e.adcashGlobalName],this.#b=e.clientHintsQueryStr,this.#E=e.isLoadedAsPartOfLibrary,this.#C=e.uniqueFingerprint,e.tagVersionSuffix&&(this.#T+=e.tagVersionSuffix)}show(e){const t=this.#S(e);fetch(t).then(e=>200===e.status||202===e.status?e.json():(204===e.status&&(this.hasNoInventory=!0,this.#i.debug(`no inventory! reset after ${this.#w} sec`),setTimeout(()=>{this.hasNoInventory=!1},1e3*this.#w),this.#w<7200&&(this.#w*=5)),Promise.reject())).then(V).then(e=>{if(this.#i.debug("response:",e),e.capped_ttl)return this.isCapped=!0,this.#i.debug(`capped! reset after ${e.capped_ttl} sec`),setTimeout(()=>{this.isCapped=!1},1e3*e.capped_ttl),void this.#n(F);this.#w>12&&(this.#w=12),this.#v?this.#y=e:(this.#i.debug("initial request. configure"),this.#v=!0,this.#t={moveTimerInsideButtonAfter:e.moveTimerInsideButtonAfter,delay:e.delay,refreshRate:e.refreshRate,isOverlay:e.isOverlay,disableCountdown:e.disableCountdown,texts:e.texts,showOnInnerLinkClick:e.showOnInnerLinkClick},this.#y=e.adPayload,this.#A=new re(this.#t,this.#n,this.#i,this.#s,this.#o)),this.#b&&(this.#y.url+=this.#b,this.#y.iurl+=this.#b,this.#y.clickPixelUrl&&(this.#y.clickPixelUrl+=this.#b)),4===this.#y.type&&this.#y.html&&(this.#y.html=`<!DOCTYPE html><html><head><meta name="referrer" content="no-referrer"></head><body>${this.#y.html}</body></html>`),this.#I()}).catch(e=>{if(e&&this.#i.error(e),e&&this.#o&&!this.#k)return this.#i.debug("fetch call failed. Switch to adblck domain and path"),this.#k=!0,this.#s.enableAdbMode(),void this.show();this.#n(F)})}#I(){this.#i.debug("render"),this.#A.render(this.#y)}#S(e){let t=`${window.location.protocol}//${this.#f}/script/interstitial.php`;if(this.#o&&this.#s.isAdbMode()){const{adserverDomain:e}=this.#o,i=`/${O("abcdefgh0123456789")}`;t=`${window.location.protocol}//${e}${i}`}return t+=`?r=${this.#d}`,this.#v&&(t+="&rbd=1"),this.#b&&(t+=this.#b),t=t+"&atag=1"+`&czid=${this.#h}`+`&aggr=${this.#u}`+`&seqid=${e}`+`&ufp=${encodeURIComponent(this.#C)}`+`&srs=${this.#s.getSesionRandomString()}`+`&cbpage=${encodeURIComponent(o())}`+`&atv=${this.#T}`+`&cbref=${encodeURIComponent(g())}`,this.#o&&(t+="&abtg=1"),this.#g&&(t+="&ppv=1"),this.#m&&(t+=`&ab_test=${this.#m}`),!1===this.#p&&(t+="&cap=0"),this.#o&&this.#o.adbVersion&&(t+=`&adbv=${this.#o.adbVersion}`),this.#s.isSandboxed()&&(t+="&sbx=1"),this.#o&&this.#s.isAdbMode()?(t+="&sadbl=2",t+="&fmt=intrn",this.#i.debug(`bid url: ${t}`),D(t)):(this.#i.debug(`bid url: ${t}`),t)}};const se=6e5,oe='[doskip*="1"]',ae="znid";let le=class{targetElementsCssSelector=null;shouldTriggerPopOnTargetClick=!1;constructor(e,t,i){this.targetElementsCssSelector=e,this.shouldTriggerPopOnTargetClick=t,this.zoneId=i}isPresent(){return!!this.targetElementsCssSelector}isActionAllowedOnElement(e){if(!this.isPresent())return!0;if(e.hasAttribute(ae))return e.getAttribute(ae)===this.zoneId;if(e.hasAttribute("doskip"))return!1;const t=Array.from(document.querySelectorAll(oe));for(const i of t)if(i.contains(e))return!1;return this.#x(e)?this.shouldTriggerPopOnTargetClick:!this.shouldTriggerPopOnTargetClick}#x(e){const t=document.querySelectorAll(this.targetElementsCssSelector);do{for(let i=0;i<t.length;i++)if(e===t[i])return!0}while(e=e.parentNode);return!1}},de=class{observer=null;iframesToOverlays=[];videosToOverlays=[];anchorsToOverlays=[];fullOverlay=null;overlaysResizeIntervalChecker=null;adUrl="";isTabSwap=!1;modifyBodyObserver=!0;#i;#d;#R=!1;constructor(e,t,i,r,n){this.elementTargeting=e,this.desktopClickListener=t,this.#i=i,this.#d=r,this.#R=n}setOverlaysResizeIntervalChecker(){this.overlaysResizeIntervalChecker=setInterval(()=>{const e=(e,t)=>{try{const i=t.getBoundingClientRect();e.style.top=`${i.top+window.scrollY}px`,e.style.left=`${i.left+window.scrollX}px`,e.style.width=`${i.width}px`,e.style.height=`${i.height}px`}catch(e){}};this.iframesToOverlays.forEach(({overlay:t,iframe:i})=>e(t,i)),this.videosToOverlays.forEach(({overlay:t,video:i})=>e(t,i)),this.anchorsToOverlays.forEach(({overlay:t,anchor:i})=>e(t,i))},500)}clearOverlaysResizeIntervalChecker(){try{clearInterval(this.overlaysResizeIntervalChecker)}catch(e){}}#N(e){const t=document.createElement("div");if(t.addEventListener("mousedown",e=>{this.#i.debug("mousedown on overlay"),e.stopPropagation(),e.preventDefault(),this.desktopClickListener(e)},this.#R),e===document.body)t.id="dontfoid",t.style.top="0px",t.style.left="0px",t.style.width=`${window.innerWidth||document.body.clientWidth}px`,t.style.height=`${window.innerHeight||document.body.clientHeight}px`,t.style.position="fixed";else{const i=e.getBoundingClientRect();t.style.top=`${i.top+window.scrollY}px`,t.style.left=`${i.left+window.scrollX}px`,t.style.width=`${i.width}px`,t.style.height=`${i.height}px`,t.style.position="absolute",t.setAttribute("donto","")}return t.setAttribute(ae,this.#d),t.style.zIndex=2147483647,t.style.backgroundColor="transparent",e===document.body?document.body.appendChild(t):e.parentNode.appendChild(t),t}attachVideoOverlays(){const e=document.querySelectorAll("video");for(let t=0;t<e.length;t++)this.elementTargeting.isActionAllowedOnElement(e[t])&&this.videosToOverlays.push({video:e[t],overlay:this.#N(e[t])})}attachIframeOverlays(){const e=document.querySelectorAll("iframe");for(let t=0;t<e.length;t++)this.elementTargeting.isActionAllowedOnElement(e[t])&&this.iframesToOverlays.push({iframe:e[t],overlay:this.#N(e[t])})}attachAnchorOverlays(){const e=document.querySelectorAll("a");for(let t=0;t<e.length;t++)this.elementTargeting.isActionAllowedOnElement(e[t])&&this.anchorsToOverlays.push({anchor:e[t],overlay:this.#N(e[t])})}clearVideoOverlays(){for(let e=0;e<this.videosToOverlays.length;e++)this.videosToOverlays[e].overlay.parentNode.removeChild(this.videosToOverlays[e].overlay),this.videosToOverlays[e].overlay=null;this.videosToOverlays.length=0}clearAnchorOverlays(){for(let e=0;e<this.anchorsToOverlays.length;e++)this.anchorsToOverlays[e].overlay.parentNode.removeChild(this.anchorsToOverlays[e].overlay),this.anchorsToOverlays[e].overlay=null;this.anchorsToOverlays.length=0}clearIframeOverlays(){for(let e=0;e<this.iframesToOverlays.length;e++)this.iframesToOverlays[e].overlay.parentNode.removeChild(this.iframesToOverlays[e].overlay),this.iframesToOverlays[e].overlay=null;this.iframesToOverlays.length=0}};class ce extends i{#s;#y=null;#t={};#L=!1;#O;#v=!1;#R=!0;#i;#T="71.2";#k=!1;#D=null;#w=12;constructor(e){super(),this.#i=new t(`atag_${e.collectiveZoneId}_suv5_${e.zoneId}`),this.#s=window[e.adcashGlobalName],this.#i.debug("init atag pop with config:",e),this.#t=e,this.elementTargeting=new le(this.#t.targetElementsCssSelector,this.#t.triggerOnTargetElementsClick,this.#t.zoneId),N&&(this.#i.debug("use capture -> false"),this.#R=!1),this.overlays=new de(this.elementTargeting,this.#P.bind(this),this.#i,this.#t.zoneId,this.#R),e.tagVersionSuffix&&(this.#T+=e.tagVersionSuffix),this.#i.debug("tag version:",this.#T)}show(){this.#y=null,this.#O=null,this.#L=!1,fetch(this.#S()).then(e=>200===e.status||202===e.status?e.json():(204===e.status&&(this.hasNoInventory=!0,this.#i.debug(`no inventory! reset after ${this.#w} sec`),setTimeout(()=>{this.hasNoInventory=!1},1e3*this.#w),this.#w<7200&&(this.#w*=5)),Promise.reject())).then(V).then(e=>{if(this.#i.debug("response:",e),e.capped_ttl)return this.isCapped=!0,this.#i.debug(`capped! reset after ${e.capped_ttl} sec`),setTimeout(()=>{this.isCapped=!1},1e3*e.capped_ttl),void this.#t.actionCallback(q);if(this.#w>12&&(this.#w=12),!this.#v){this.#v=!0;const t=e.delay??0;return this.#i.debug("delay is",t),void setTimeout(()=>{this.#U(e)},1e3*t)}this.#U(e)}).catch(e=>{if(e&&this.#i.error(e),e&&this.#t.adblockSettings&&!this.#k)return this.#i.debug("fetch call failed. Switch to adblck domain and path"),this.#s.enableAdbMode(),this.#k=!0,void this.show();this.#t.actionCallback(q)})}#S(){let e=`${window.location.protocol}//${this.#t.adserverDomain}/script/suurl5.php`;if(this.#t.adblockSettings&&this.#s.isAdbMode()){const{adserverDomain:t}=this.#t.adblockSettings,i=`/${O("abcdefgh0123456789")}`;e=`${window.location.protocol}//${t}${i}`}if(e+=`?r=${this.#t.zoneId}`,this.#v&&(e+="&rbd=1"),this.#t.targetCountries){const t=this.#t.targetCountries.join(",");this.#t.triggerOnTargetCountries?e+="&allowed_countries="+encodeURIComponent(t):e+="&excluded_countries="+encodeURIComponent(t)}return e=e+this.#t.clientHintsQueryStr+"&atag=1&cbur="+Math.random()+"&cbiframe="+a()+"&cbWidth="+c()+"&cbHeight="+h()+"&cbtitle="+encodeURIComponent(u())+"&cbpage="+encodeURIComponent(o())+"&cbref="+encodeURIComponent(g())+"&cbdescription="+encodeURIComponent(p("description"))+"&cbkeywords="+encodeURIComponent(p("keywords"))+"&cbcdn="+encodeURIComponent(this.#s.getCdnDomain())+"&ts="+Date.now()+"&atv="+this.#T+"&ufp="+encodeURIComponent(this.#t.uniqueFingerprint)+"&srs="+this.#s.getSesionRandomString(),this.#t.adblockSettings&&(e+="&abtg=1"),this.#t.aggressivity&&(e+=`&aggr=${this.#t.aggressivity}`),this.#t.collectiveZoneId&&(e+=`&czid=${this.#t.collectiveZoneId}`),this.#t.recordPageView&&(e+="&ppv=1"),this.#t.abTest&&(e+=`&ab_test=${this.#t.abTest}`),!1===this.#t.adsCapping&&(e+="&cap=0"),this.#t.adblockSettings&&this.#t.adblockSettings.adbVersion&&(e+=`&adbv=${this.#t.adblockSettings.adbVersion}`),this.#s.isSandboxed()&&(e+="&sbx=1"),this.#t.adblockSettings&&this.#s.isAdbMode()?(e+="&sadbl=2",e+="&fmt=suv5",this.#i.debug(`bid url: ${e}`),D(e)):(this.#i.debug(`bid url: ${e}`),e)}#$(e){try{let t=this.#D?this.#D(""):window.open("");return t.document.open(),t.document.writeln('<meta name="referrer" content="no-referrer"><script type="text/javascript">window.location = "'+e+'";<\/script>'),t.document.close(),t}catch(e){return this.#i.error("window open failed:",e),null}}#V(){if("complete"===document.readyState&&void 0!==document.body){const e=document.createElement("iframe");return e.width="0",e.height="0",e.tabindex="-1",e.style="position:absolute;top:-1000px;left:-1000px;visibility:hidden;border:medium none;background-color:transparent;",document.body.appendChild(e),void(this.#D=e.contentWindow.open.bind(e.contentWindow))}setTimeout(this.#V.bind(this),50)}#U(e){this.#y={url:this.#M(e.url),impressionUrl:e.iurl,refreshRate:e.refreshRate,delay:e.delay,type:e.type},e.targetElementsCssSelector&&!this.elementTargeting.targetElementsCssSelector&&(this.elementTargeting.targetElementsCssSelector=e.targetElementsCssSelector,this.elementTargeting.shouldTriggerPopOnTargetClick=e.triggerOnTargetElementsClick),this.overlays.attachAnchorOverlays(),this.overlays.attachIframeOverlays(),this.overlays.attachVideoOverlays(),this.overlays.setOverlaysResizeIntervalChecker(),this.#F(),this.#i.debug("ready to show ad")}#q(){return"type"in this.#y&&"tabswap"===this.#y.type}#z(){this.#i.debug("do tabswap"),this.#t.actionCallback(z);const e=this.#y.url;this.#D?this.#O=this.#D(window.location.href,"_blank","noreferrer"):this.#O=window.open(window.location.href,"_blank","noreferrer"),this.#B().finally(()=>{setTimeout(()=>{const t=document.createElement("a");t.href=e,t.rel="noopener noreferrer",document.body.appendChild(t),t.click(),document.body.removeChild(t)},50)})}async#B(e=0){const t=this.#O?"1":"0";this.#i.debug("window opened:",t);let i=this.#y.impressionUrl+`&wo=${t}`;if(window["utsid-send"]&&(i+=`&utsid=${window["utsid-send"]}`),e>0&&(this.#i.debug(`retry impression. Attempt ${e}`),i+=`&rtry=${e}`),i=i+this.#t.clientHintsQueryStr+"&cbpage="+encodeURIComponent(o())+"&cbref="+encodeURIComponent(g()),this.#i.debug("send impression. url:",i),U){this.#i.debug("keepalive supported!");let t=null,r=!1;try{t=await fetch(i,{keepalive:!0})}catch(e){if(this.#i.error(e),this.#t.adblockSettings&&!this.#s.isAdbMode())return this.#i.debug("imp failed: try alt domain and path"),void this.#s.enableAdbMode();r=!0}if(t&&!t.ok||r)return void(e<2&&(await this.#B(e+1),document.dispatchEvent(new CustomEvent("impression-retry-event"))))}else navigator.sendBeacon?(this.#i.debug("keepalive NOT supported! use sendBeacon"),navigator.sendBeacon(i)):(this.#i.debug("keepalive NOT supported! use image.src"),(new Image).src=i);document.dispatchEvent(new CustomEvent("impression-event"))}#H(){this.overlays.clearOverlaysResizeIntervalChecker(),this.overlays.clearAnchorOverlays(),this.overlays.clearIframeOverlays(),this.overlays.clearVideoOverlays(),this.#y=null,this.#_(),this.#s.isShowingPop=!1,this.#t.actionCallback(q)}#P(e){this.#i.debug(`showAdClickListener triggered by event type ${e.type} on ${e.target.tagName}`),e.isTrusted?this.#y?this.#L?this.#i.debug(`${e.type} on ${e.target.tagName}:pop rejected: current pop is locked`):this.#s.isShowingPop?this.#i.debug(`${e.type} on ${e.target.tagName}: pop rejected: another pop is being currently shown`):this.elementTargeting.isActionAllowedOnElement(e.target)?(this.#s.isShowingPop=!0,this.#L=!0,this.#i.debug("triggering pop"),this.#q()?this.#z():(this.#D?this.#O=this.#D(this.#y.url,"_blank","noopener,noreferrer"):this.#O=window.open(this.#y.url,"_blank","noopener,noreferrer"),this.#B().finally(()=>{this.#H()}))):this.#i.debug(`${e.type} on ${e.target.tagName}: pop rejected: action not allowed on element`,e.target):this.#i.debug(`${e.type} on ${e.target.tagName}: pop rejected: current pop has no ad loaded`):this.#i.debug(`${e.type} on ${e.target.tagName}: pop rejected: event is not trusted`)}#M(e){let t=e;return b&&w<59||v&&w<56?t='data:text/html;charset=utf-8, <html><meta http-equiv="refresh" content="0;URL='+e+'"></html>':A&&b&&!m&&w>63&&(e="googlechrome://"+e.replace(/(^\w+:|^)\/\//,"")),t}#F(){const e={zoneId:this.#t.zoneId,callback:this.#P.bind(this)};N&&L&&(this.#i.debug("subscribe to scroll"),this.#s.subscribe("scroll",e)),N||(this.#i.debug("subscribe to mousedown"),this.#s.subscribe("mousedown",e,this.#R)),this.#i.debug("subscribe to click"),this.#s.subscribe("click",e,this.#R)}#_(){N&&L&&(this.#i.debug("unsubscribe from scroll"),this.#s.unsubscribe("scroll",this.#t.zoneId)),N||(this.#i.debug("unsubscribe from mousedown"),this.#s.unsubscribe("mousedown",this.#t.zoneId,this.#R)),this.#i.debug("unsubscribe from click"),this.#s.unsubscribe("click",this.#t.zoneId,this.#R)}}class he{constructor(e){this.key=e}isStatePresent(){return null!==window.localStorage.getItem(this.key)}getState(){return JSON.parse(window.localStorage.getItem(this.key))}setState(e){window.localStorage.setItem(this.key,JSON.stringify(e))}removeState(){window.localStorage.removeItem(this.key)}}class ue{#i;#s;#W=null;#j=null;#h;#G=[];#Z=0;#K=null;#Q=1;#X=0;#Y=!1;constructor(e){const{adcashGlobalName:i,collectiveZoneConfig:r,adserverDomain:n,adblockSettings:s,clientHintsQueryStr:o,tagVersionSuffix:a,isLoadedAsPartOfLibrary:l,uniqueFingerprint:d}=e,{collectiveZoneId:c}=r;this.#i=new t(`atag_${c}`),this.#s=window[e.adcashGlobalName],this.#G=r.rotationList,this.#i.debug("init autotag with config:",e);const h=r.indexedFormats;let u=!0;for(const e in h){const t=h[e];switch(e){case"ippg":this.#s.runInPagePush({zoneId:t.zoneId.toString(),refreshRate:t.rr,delay:t.d,maxAds:t.mads,renderPosDesktop:t["render-pos-desktop"],renderPosMobile:t["render-pos-mobile"],offsetTop:t["offset-top"],isAutoTag:!0,collectiveZoneId:c,aggressivity:r.aggressivity,abTest:r.ab_test,recordPageView:u,tagVersionSuffix:a});break;case"suv4":case"pop":this.#j=new ce({zoneId:t.zoneId.toString(),targetElementsCssSelector:t["element-list"],triggerOnTargetElementsClick:"allow"===t["element-action"],targetCountries:t["country-list"],triggerOnTargetCountries:"allow"===t["country-action"],adblockSettings:s,adserverDomain:n,adcashGlobalName:i,clientHintsQueryStr:o,collectiveZoneId:c,aggressivity:r.aggressivity,adsCapping:r.adsCapping,abTest:r.ab_test,recordPageView:u,actionCallback:this.actionCallback.bind(this),tagVersionSuffix:a,isLoadedAsPartOfLibrary:l,uniqueFingerprint:d});break;case"interstitial":this.#W=new ne({zoneId:t.zoneId,isFullscreen:0===t.overlay,adblockSettings:s,adserverDomain:n,adcashGlobalName:i,clientHintsQueryStr:o,collectiveZoneId:c,aggressivity:r.aggressivity,adsCapping:r.adsCapping,abTest:r.ab_test,recordPageView:u,actionCallback:this.actionCallback.bind(this),tagVersionSuffix:a,isLoadedAsPartOfLibrary:l,uniqueFingerprint:d});break;default:this.#i.error(`ad format type not recognised from collective zone config. adformat.type: ${e}; czid: ${czid}`)}}this.localStorageService=new he(`atg_${c}`);const g=this.localStorageService.getState();g&&g.adbExpiresAt>Date.now()&&this.#s.enableAdbMode(),g&&g.expiresAt>Date.now()?(this.#i.debug("previous session present:",g),this.#Q=g.shownAdsCounter,this.#X=g.iterationCounter,this.#Z=g.currentAdIndex,g.isInterstitialBeingShown?this.#J():(this.#K=this.#G[this.#Z],this.#ee())):(this.#K=this.#G[this.#Z],this.#ee())}actionCallback(e){this.#i.debug("ACTION CALLBACK type:",e),e===F?this.#Y=!1:this.#Q++;const t=this.#K.rotationInterval;this.#te(),this.#ie(),e===z?this.#i.debug("tabswap, move to next and store session"):(this.#i.debug(`show next ad after ${t} sec`),setTimeout(this.#ee.bind(this),1e3*t))}#ie(){const e={shownAdsCounter:this.#Q,iterationCounter:this.#X,currentAdIndex:this.#Z,isInterstitialBeingShown:this.#Y,expiresAt:Date.now()+6e5,adbExpiresAt:this.#s.isAdbMode()?Date.now()+se:0};this.#i.debug("store session state",e),this.localStorageService.setState(e)}#re(){if(!this.#K.apply)return!1;switch(this.#K.apply){case"1st":return!(0===this.#X);case"odd":return!(this.#X%2==1);case"even":return!(this.#X%2==0);default:return!1}}#te(){this.#Z===this.#G.length-1?(this.#Z=0,this.#X++):this.#Z++,this.#K=this.#G[this.#Z],this.#i.debug("set current ad to next on list. current ad is set to:",this.#K)}#J(){this.#i.debug("show next ad"),this.#te(),this.#ie(),this.#ee()}#ee(){if(this.#re())return this.#i.debug(`skipping ad at index: ${this.#Z} due to apply rule`),void this.#J();switch(this.#K.type){case"interstitial":if(this.#W.isCapped||this.#W.hasNoInventory)return void setTimeout(this.#J.bind(this),1e3);this.#i.debug("showing interstitial"),this.#W.show(this.#Q),this.#Y=!0,this.#Q++,this.#ie();break;case"pop":if(this.#j.isCapped||this.#j.hasNoInventory)return void setTimeout(this.#J.bind(this),1e3);this.#i.debug("showing pop"),this.#j.show(this.#Q);break;default:throw Error(`rotation list element type '${this.#K.type}' not recognised`)}}}const ge=function(){this.element===window?(this.divOverlay.style.width=`${window.innerWidth||document.body.clientWidth}px`,this.divOverlay.style.height=`${window.innerHeight||document.body.clientHeight}px`):(this.divOverlay.style.top=`${this.element.offsetTop}px`,this.divOverlay.style.left=`${this.element.offsetLeft}px`,this.divOverlay.style.width=`${this.element.offsetWidth}px`,this.divOverlay.style.height=`${this.element.offsetHeight}px`,this.divOverlay.style.zIndex=Y)};class pe{observer=null;iframesToOverlays=[];videosToOverlays=[];anchorsToOverlays=[];fullOverlay=null;overlaysResizeIntervalChecker=null;adUrl="";isTabSwap=!1;modifyBodyObserver=!0;#i;#d;#R=!1;constructor(e,t,i,r,n,s){this.elementTargeting=e,this.desktopClickListener=t,this.mobileClickListener=i,this.#i=r,this.#d=n,this.#R=s}setOverlaysResizeIntervalChecker(){this.overlaysResizeIntervalChecker=setInterval(()=>{const e=(e,t)=>{try{const i=t.getBoundingClientRect();e.style.top=`${i.top+window.scrollY}px`,e.style.left=`${i.left+window.scrollX}px`,e.style.width=`${i.width}px`,e.style.height=`${i.height}px`}catch(e){}};this.anchorsToOverlays.forEach(({overlay:t,anchor:i})=>e(t,i)),this.iframesToOverlays.forEach(({overlay:t,iframe:i})=>e(t,i)),this.videosToOverlays.forEach(({overlay:t,video:i})=>e(t,i))},500)}clearOverlaysResizeIntervalChecker(){try{clearInterval(this.overlaysResizeIntervalChecker)}catch(e){}}#ne(){const e=document.createElement("a");return e.setAttribute("href",this.adUrl),e.setAttribute("target","_blank"),e.setAttribute("rel","noopener noreferrer"),e.innerText="",e.addEventListener("click",e=>{this.#i.debug("click on overlay is mobile no tabswap no capture"),e.stopPropagation(),this.mobileClickListener(e)}),e}#se(){const e=document.createElement("div");return e.addEventListener("mousedown",e=>{this.#i.debug("mousedown on overlay"),this.desktopClickListener(e)},this.#R),e.addEventListener("click",e=>{this.#i.debug("click on overlay"),this.desktopClickListener(e)},this.#R),e}#N(e){let t;const i=e===document.body;if(t=N&&i&&!this.isTabSwap?this.#ne():this.#se(),i)t.id=J,t.style.top="0px",t.style.left="0px",t.style.width=`${window.innerWidth||document.body.clientWidth}px`,t.style.height=`${window.innerHeight||document.body.clientHeight}px`,t.style.position="fixed";else{const i=e.getBoundingClientRect();t.style.top=`${i.top+window.scrollY}px`,t.style.left=`${i.left+window.scrollX}px`,t.style.width=`${i.width}px`,t.style.height=`${i.height}px`,t.style.position="absolute",t.setAttribute(ee,"")}return t.setAttribute(te,this.#d),t.style.zIndex=this.#oe(e).toString(),t.style.backgroundColor="transparent",document.body.appendChild(t),t}attachVideoOverlays(){const e=document.querySelectorAll("video");for(let t=0;t<e.length;t++)this.elementTargeting.isActionAllowedOnElement(e[t])&&(this.videosToOverlays.push({video:e[t],overlay:this.#N(e[t])}),this.#i.debug("VIDEO OVERLAY ATTACHED TO",this.videosToOverlays[this.videosToOverlays.length-1]))}attachIframeOverlays(){const e=document.querySelectorAll("iframe");for(let t=0;t<e.length;t++)this.elementTargeting.isActionAllowedOnElement(e[t])&&(this.iframesToOverlays.push({iframe:e[t],overlay:this.#N(e[t])}),this.#i.debug("IFRAME OVERLAY ATTACHED TO",this.iframesToOverlays[this.iframesToOverlays.length-1]))}attachAnchorOverlays(){const e=document.querySelectorAll("a");for(let t=0;t<e.length;t++)this.elementTargeting.isActionAllowedOnElement(e[t])&&this.anchorsToOverlays.push({anchor:e[t],overlay:this.#N(e[t])})}clearVideoOverlays(){for(let e=0;e<this.videosToOverlays.length;e++)this.videosToOverlays[e].overlay.parentNode.removeChild(this.videosToOverlays[e].overlay),this.videosToOverlays[e].overlay=null;this.videosToOverlays.length=0}clearAnchorOverlays(){for(let e=0;e<this.anchorsToOverlays.length;e++)this.anchorsToOverlays[e].overlay.parentNode.removeChild(this.anchorsToOverlays[e].overlay),this.anchorsToOverlays[e].overlay=null;this.anchorsToOverlays.length=0}clearIframeOverlays(){for(let e=0;e<this.iframesToOverlays.length;e++)this.iframesToOverlays[e].overlay.parentNode.removeChild(this.iframesToOverlays[e].overlay),this.iframesToOverlays[e].overlay=null;this.iframesToOverlays.length=0}attachFullOverlay=()=>{const e=this.#N(document.body);if(f||(r(window,"resize",ge.bind({divOverlay:e,element:window})),r(document.body,"resize",ge.bind({divOverlay:e,element:window}))),this.fullOverlay=e,this.modifyBodyObserver)try{this.#ae()}catch(e){this.#i.error(e)}};clearFullOverlay(){this.#i.debug("clear full overlay"),this.fullOverlay?(this.modifyBodyObserver&&this.#le(),f||(n(window,ge),n(document.body,ge)),this.fullOverlay.parentNode.removeChild(this.fullOverlay),this.fullOverlay=null):this.#i.debug("no overlay to clear")}reattachFullOverlay(){this.modifyBodyObserver=!1,this.clearFullOverlay(),this.attachFullOverlay(),this.modifyBodyObserver=!0}#oe(e){if(e!==document.body&&this.elementTargeting.isPresent()&&!this.elementTargeting.shouldTriggerPopOnTargetClick){const t=window.getComputedStyle(e);let i=parseInt(t.zIndex,10);return Number.isNaN(i)?i=1:i+=1,i}return Y}#ae(){this.observer=new MutationObserver(e=>{for(let t=0;t<e.length;t++){const i=e[t];for(let e=0;e<i.addedNodes.length;e++)if(i.addedNodes[e].style&&parseInt(i.addedNodes[e].style.zIndex,10)>=1&&i.addedNodes[e].id!==J&&!i.addedNodes[e].hasAttribute("dontfo")&&!i.addedNodes[e].hasAttribute(ee))return this.#i.debug("observed element",i.addedNodes[e],"with zIndex value larger or equal to our full body overlay. reattaching full body overlay"),void this.reattachFullOverlay()}}),this.observer.observe(document.body,{attributes:!1,childList:!0,subtree:!0})}#le(){this.observer&&this.observer.disconnect(),this.observer=null}}class me{targetElementsCssSelector=null;shouldTriggerPopOnTargetClick=!1;#de=!1;constructor(e,t,i){this.targetElementsCssSelector=e,this.shouldTriggerPopOnTargetClick=t,this.zoneId=i}isPresent(){return!!this.targetElementsCssSelector}preventClickOnInterstitialAndBanner(){this.#de=!0}isActionAllowedOnElement(e,t=[],i=[]){if(e.hasAttribute(te))return e.getAttribute(te)===this.zoneId;if(e.hasAttribute("doskip"))return"1"===e.getAttribute(ie)&&!this.#de;0===t.length&&(t=Array.from(document.querySelectorAll(oe)));for(const i of t)if(i.contains(e))return"1"===e.getAttribute(ie)&&!this.#de;if(this.isPresent()){0===i.length&&(i=document.querySelectorAll(this.targetElementsCssSelector));for(let t=0;t<i.length;t++)if(e===i[t])return this.shouldTriggerPopOnTargetClick;return!this.shouldTriggerPopOnTargetClick}return!0}}const fe=Math.random()<.5;class be{#t={};#i=null;#r=0;#n;#s;#o;constructor(e,t,i,r,n){this.#t=e,this.#i=i,this.#r=0,this.#n=t,this.#s=r,this.#o=n}render(e){let t=null;switch(e.type){case 1:this.#i.debug(`rendering INTERSTITIAL IFRAME (type 1) in ${this.#t.isOverlay?"OVERLAY":"FULLSCREEN"} mode`),t=this.#t.isOverlay?_(e.url):Z(e.url);break;case 3:this.#i.debug(`rendering INTERSTITIAL IMAGE (type 3) in ${this.#t.isOverlay?"OVERLAY":"FULLSCREEN"} mode`),t=this.#t.isOverlay?W(e.url,e.ad.url,e.ad.width,e.ad.height):K(e.url,e.ad.url,e.ad.width,e.ad.height);break;case 4:if(e.isHtmlTemplate)return this.#i.debug("rendering INTERSTITIAL HTML CUSTOM (type 4)"),void this.#a(e);this.#i.debug(`rendering INTERSTITIAL HTML (type 4) in ${this.#t.isOverlay?"OVERLAY":"FULLSCREEN"} mode`),t=this.#t.isOverlay?j(ie):Q(ie);break;default:return void this.#i.error(`no such type of interstitial: ${e.type}`)}const i=document.createElement("div");document.body.appendChild(i);const r=i.attachShadow({mode:"open"}),n=this.#t.isOverlay?H:G;if(r.appendChild(n(this.#t.texts.goToButton,e.url,this.#l(),t.content,e.iurl)),4===e.type){const t=r.getElementById("creative_iframe");t.contentWindow.contents=e.html,t.src='javascript:window["contents"]'}if(!this.#t.disableCountdown&&this.#t.moveTimerInsideButtonAfter>0){this.#r=this.#t.moveTimerInsideButtonAfter,r.getElementById("closeButton").innerHTML=this.#l();const e=setInterval(()=>{this.#r--,r.getElementById("closeButton").innerHTML=this.#l(),0===this.#r&&clearInterval(e)},1e3)}r.getElementById("closeButton").addEventListener("click",()=>{this.#r>0||(this.#i.debug("close button click. remove modal host, resize listener if present and do callback"),i.remove(),t.resizeFunc&&window.removeEventListener("resize",t.resizeFunc),this.#n())})}#l(){let e=`${this.#t.texts.pleaseWait}: ${this.#r} ${this.#t.texts.timePlural}`;return 1===this.#r&&(e=`${this.#t.texts.pleaseWait}: ${this.#r} ${this.#t.texts.timeSingle}`),0===this.#r&&(e=this.#t.disableCountdown?this.#t.texts.xLabel:this.#t.texts.skipAd),e}#a(e){const t=(new DOMParser).parseFromString(e.html,"text/html").querySelector("script"),i=document.createElement("script");i.style.zIndex="2147483646",t.src?i.setAttribute("src",t.src):i.innerText=t.innerText;const s=()=>{this.#i.debug("CT-CLICK"),fetch(e.link,{mode:"no-cors"}),n(document,"ct-click",s)},o=()=>{this.#i.debug("CT-CLOSE"),n(document,"ct-click",s),n(document,"ct-close",o),document.body.removeChild(i),this.#n()};r(document,"ct-click",s),r(document,"ct-close",o);let a=e.iurl;window[B]&&(a+=`&utsid=${window[B]}`),i.onload=async()=>{try{await fetch(a.toString())}catch(e){return this.#i.debug(e),void(this.#o&&!this.#s.isAdbMode()&&(this.#i.debug("imp failed: try alt domain and path"),this.#s.enableAdbMode()))}document.dispatchEvent(new CustomEvent("impression-event"))},i.onerror=()=>{this.#i.debug("custom html script failed to load"),this.#n(F)},document.body.appendChild(i)}}const ve="#399afe",ye="inpageclick",we="inpageclose",Te="utsid-send";class Ae extends HTMLElement{#ce;constructor(){super(),this._shadowRoot=this.attachShadow({mode:"open"}),this.click=e=>{e.stopPropagation();const t=new CustomEvent(ye,{bubbles:!0});this.dispatchEvent(t)},this.close=e=>{e.stopPropagation();const t=new CustomEvent(we,{bubbles:!0});this.dispatchEvent(t)},this.missclick=()=>{document.dispatchEvent(new CustomEvent("in-page-missclick"))}}connectedCallback(){const e=document.querySelectorAll("in-page-message");let t=0,i="top";for(let i=0;i<e.length;i++)e[i].shadowRoot.childNodes[0]?.offsetHeight&&(t+=e[i].shadowRoot.childNodes[0].offsetHeight);const n=parseInt(this.getAttribute("data-offset-top"),10),s=this.getAttribute("data-render-pos-desktop"),a=this.getAttribute("data-render-pos-mobile");n?t+=n:i=N?a:s;const l=(e=>{const[t,i="right"]=e.position.split("-"),r=document.createElement("div");r.id=`note-${e.id}`,r.style[t]=`${e.offset}px`,r.style[i]="0",r.style.fontFamily='-apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif',r.style.fontWeight="400",r.style.fontSize="16px",r.style.lineHeight="1.3",r.style.position="fixed",r.style.letterSpacing="-0.31em",r.style.textRendering="optimizespeed",r.style.display="flex",r.style.webkitBoxOrient="horizontal",r.style.webkitBoxDirection="normal",r.style.msFlexFlow="row wrap",r.style.alignContent="flex-start",r.style.alignItems="center",r.style.cursor="pointer",r.style.transition="padding-right 0.1s, top 0.3s",r.style.overflow="hidden",r.style.zIndex="2147483642",r.style.wordWrap="break-word",r.style.width="380px",r.style.paddingTop="20px";const n=()=>{window.innerWidth<380?r.style.width="100%":r.style.width="380px"};n();const s=document.createElement("div");s.style.margin="5px",s.style.borderRadius="55px",s.style.position="relative",s.style.background=ve,s.style.color="#ffffff",s.style.width="70%",s.style.textAlign="center",s.style.height="100px",s.style.justifyContent="center",s.style.display="flex",s.style.alignItems="center";const o=document.createElement("p");o.style.width="90%",o.style.padding="2%",o.style.fontSize="0.9em",o.style.display="inline-block",o.style.letterSpacing="normal",o.style.wordSpacing="normal",o.style.verticalAlign="middle",o.style.textRendering="auto",o.style.textAlign="center";const a=document.createElement("b");a.textContent=e.dataTitle;const l=document.createElement("br"),d=document.createTextNode(e.dataDescription),c=document.createElement("img");c.classList.add("graph"),c.src=e.dataIcon,c.alt="graph",c.style.width="76px",c.style.height="76px",c.style.boxSizing="border-box",c.style.borderRadius="50%",c.style.position="relative",c.style.marginLeft="2%",c.style.border=`4px solid ${ve}`,c.style.display="inline-block",c.style.letterSpacing="normal",c.style.wordSpacing="normal",c.style.verticalAlign="middle",c.style.textRendering="auto",c.style.textAlign="center";const h=document.createElement("div");h.id=`missclick-${e.id}`,h.style.right="0",h.style.top="0",h.style.height="100%",h.style.width=`${e.widthOfMissclickArea}px`,h.style.zIndex="2",h.style.position="absolute",h.style.alignItems="start",h.style.justifyContent="center",h.style.display="flex";const u=document.createElement("div");return u.id=`close-${e.id}`,u.innerHTML="&#10005",u.style.fontSize="20px",u.style.marginTop="10px",u.style.zIndex="23",u.style.display="inline-block",u.style.width="24px",u.style.height="24px",u.style.background="transparent",u.style.textAlign="center",u.style.color="#a6a0a7",u.style.letterSpacing="normal",u.style.wordSpacing="normal",u.style.verticalAlign="middle",u.style.textRendering="auto",u.onmouseover=()=>{u.style.background="#a0a0ff"},u.onmouseout=()=>{u.style.background="transparent"},o.appendChild(a),o.appendChild(l),o.appendChild(d),s.appendChild(o),h.appendChild(u),r.appendChild(s),r.appendChild(c),r.appendChild(h),{content:r,resizeFunc:n}})({id:this.getAttribute("id"),position:i,offset:t,dataTitle:this.getAttribute("data-title"),dataDescription:this.getAttribute("data-description"),dataIcon:this.getAttribute("data-icon"),widthOfMissclickArea:50});this.shadowRoot.appendChild(l.content),this.#ce=l.resizeFunc;const d=this.shadowRoot.getElementById(`note-${this.getAttribute("id")}`),c=this.shadowRoot.getElementById(`close-${this.getAttribute("id")}`),h=this.shadowRoot.getElementById(`missclick-${this.getAttribute("id")}`);if(this.hasAttribute("data-imp-link")){let e=this.getAttribute("data-imp-link");window[Te]&&(e+=`&utsid=${window[Te]}`),e+=`&cbpage=${encodeURIComponent(o())}`,e+=`&cbref=${encodeURIComponent(g())}`;const t=document.createElement("img");t.src=e.toString(),t.style.display="none",t.width=0,t.height=0,d.appendChild(t)}r(d,"click",this.click),r(c,"click",this.close),r(h,"click",this.missclick)}resize(){this.#ce&&this.#ce()}}function ke(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:e.id||null,adId:e.adId||null,sequence:e.sequence||null,apiFramework:e.apiFramework||null,universalAdIds:[],creativeExtensions:[]}}const Ee=["ADCATEGORIES","ADCOUNT","ADPLAYHEAD","ADSERVINGID","ADTYPE","APIFRAMEWORKS","APPBUNDLE","ASSETURI","BLOCKEDADCATEGORIES","BREAKMAXADLENGTH","BREAKMAXADS","BREAKMAXDURATION","BREAKMINADLENGTH","BREAKMINDURATION","BREAKPOSITION","CLICKPOS","CLICKTYPE","CLIENTUA","CONTENTID","CONTENTPLAYHEAD","CONTENTURI","DEVICEIP","DEVICEUA","DOMAIN","EXTENSIONS","GDPRCONSENT","IFA","IFATYPE","INVENTORYSTATE","LATLONG","LIMITADTRACKING","MEDIAMIME","MEDIAPLAYHEAD","OMIDPARTNER","PAGEURL","PLACEMENTTYPE","PLAYERCAPABILITIES","PLAYERSIZE","PLAYERSTATE","PODSEQUENCE","REGULATIONS","SERVERSIDE","SERVERUA","TRANSACTIONID","UNIVERSALADID","VASTVERSIONS","VERIFICATIONVENDORS"];function Ce(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=[],n=xe(e);!t.ERRORCODE||i.isCustomCode||/^[0-9]{3}$/.test(t.ERRORCODE)||(t.ERRORCODE=900),t.CACHEBUSTING=De(Math.round(1e8*Math.random())),t.TIMESTAMP=(new Date).toISOString(),t.RANDOM=t.random=t.CACHEBUSTING;for(const e in t)t[e]=Oe(t[e]);for(const e in n){const i=n[e];"string"==typeof i&&r.push(Se(i,t))}return r}function Se(e,t){const i=(e=Ie(e,t)).match(/[^[\]]+(?=])/g);if(!i)return e;let r=i.filter(e=>Ee.indexOf(e)>-1);return 0===r.length?e:(r=r.reduce((e,t)=>(e[t]=-1,e),{}),Ie(e,r))}function Ie(e,t){let i=e;for(const e in t){const r=t[e];i=i.replace(new RegExp("(?:\\[|%%)(".concat(e,")(?:\\]|%%)"),"g"),r)}return i}function xe(e){return Array.isArray(e)?e.map(e=>e&&e.hasOwnProperty("url")?e.url:e):e}function Re(e){return/^(https?:\/\/|\/\/)/.test(e)}function Ne(e,t){for(let i=0;i<t.length;i++)if(Le(t[i],e))return!0;return!1}function Le(e,t){if(e&&t){const i=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(t);return i.length===r.length&&e.id===t.id&&e.url===t.url}return!1}function Oe(e){return encodeURIComponent(e).replace(/[!'()*]/g,e=>"%".concat(e.charCodeAt(0).toString(16)))}function De(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;return e.toString().padStart(t,"0")}const Pe={track:function(e,t,i){Ce(e,t,i).forEach(e=>{"undefined"!=typeof window&&null!==window&&((new Image).src=e)})},resolveURLTemplates:Ce,extractURLsFromTemplates:xe,filterUrlTemplates:function(e){return e.reduce((e,t)=>{const i=t.url||t;return Re(i)?e.validUrls.push(i):e.invalidUrls.push(i),e},{validUrls:[],invalidUrls:[]})},containsTemplateObject:Ne,isTemplateObjectEqual:Le,encodeURIComponentRFC3986:Oe,replaceUrlMacros:Se,isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},flatten:function e(t){return t.reduce((t,i)=>t.concat(Array.isArray(i)?e(i):i),[])},joinArrayOfUniqueTemplateObjs:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const i=Array.isArray(e)?e:[],r=Array.isArray(t)?t:[];return i.concat(r).reduce((e,t)=>(Ne(t,e)||e.push(t),e),[])},isValidTimeValue:function(e){return Number.isFinite(e)&&e>=-2},addLeadingZeros:De,isValidUrl:Re,isBrowserEnvironment:function(){return"undefined"!=typeof window},formatMacrosValues:function(e){return"object"!=typeof e?e:JSON.stringify(e)}};function Ue(e){return["true","TRUE","True","1"].includes(e)}const $e={childByName:function(e,t){return Array.from(e.childNodes).find(e=>e.nodeName===t)},childrenByName:function(e,t){return Array.from(e.childNodes).filter(e=>e.nodeName===t)},resolveVastAdTagURI:function(e,t){if(!t)return e;if(e.startsWith("//")){const{protocol:t}=location;return"".concat(t).concat(e)}if(!e.includes("://")){const i=t.slice(0,t.lastIndexOf("/"));return"".concat(i,"/").concat(e)}return e},parseBoolean:Ue,parseNodeText:function(e){return e&&(e.textContent||e.text||"").trim()},copyNodeAttribute:function(e,t,i){const r=t.getAttribute(e);r&&i.setAttribute(e,r)},parseAttributes:function(e){return Array.from(e.attributes).reduce((e,t)=>(e[t.nodeName]=t.nodeValue,e),{})},parseDuration:function(e){if(null==e)return-1;if(Pe.isNumeric(e))return parseInt(e);const t=e.split(":");if(3!==t.length)return-1;const i=t[2].split(".");let r=parseInt(i[0]);2===i.length&&(r+=parseFloat("0.".concat(i[1])));const n=parseInt(60*t[1]),s=parseInt(60*t[0]*60);return isNaN(s)||isNaN(n)||isNaN(r)||n>3600||r>60?-1:s+n+r},getStandAloneAds:function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter(e=>!parseInt(e.sequence,10))},getSortedAdPods:function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter(e=>parseInt(e.sequence,10)).sort((e,t)=>e.sequence-t.sequence)},assignAttributes:function(e,t){e&&Array.from(e).forEach(e=>{let{nodeName:i,nodeValue:r}=e;if(i&&r&&t.hasOwnProperty(i)){let e=r;"boolean"==typeof t[i]&&(e=Ue(e)),t[i]=e}})},mergeWrapperAdData:function(e,t){var i;e.errorURLTemplates=t.errorURLTemplates.concat(e.errorURLTemplates),e.impressionURLTemplates=t.impressionURLTemplates.concat(e.impressionURLTemplates),e.extensions=t.extensions.concat(e.extensions),t.viewableImpression.length>0&&(e.viewableImpression=[...e.viewableImpression,...t.viewableImpression]),e.followAdditionalWrappers=t.followAdditionalWrappers,e.allowMultipleAds=t.allowMultipleAds,e.fallbackOnNoAd=t.fallbackOnNoAd;const r=(t.creatives||[]).filter(e=>e&&"companion"===e.type),n=r.reduce((e,t)=>((t.variations||[]).forEach(t=>{(t.companionClickTrackingURLTemplates||[]).forEach(t=>{Pe.containsTemplateObject(t,e)||e.push(t)})}),e),[]);e.creatives=r.concat(e.creatives);const s=t.videoClickTrackingURLTemplates&&t.videoClickTrackingURLTemplates.length,o=t.videoCustomClickURLTemplates&&t.videoCustomClickURLTemplates.length;if(e.creatives.forEach(e=>{if(t.trackingEvents&&t.trackingEvents[e.type])for(const i in t.trackingEvents[e.type]){const r=t.trackingEvents[e.type][i];Array.isArray(e.trackingEvents[i])||(e.trackingEvents[i]=[]),e.trackingEvents[i]=e.trackingEvents[i].concat(r)}"linear"===e.type&&(s&&(e.videoClickTrackingURLTemplates=e.videoClickTrackingURLTemplates.concat(t.videoClickTrackingURLTemplates)),o&&(e.videoCustomClickURLTemplates=e.videoCustomClickURLTemplates.concat(t.videoCustomClickURLTemplates)),!t.videoClickThroughURLTemplate||null!==e.videoClickThroughURLTemplate&&void 0!==e.videoClickThroughURLTemplate||(e.videoClickThroughURLTemplate=t.videoClickThroughURLTemplate)),"companion"===e.type&&n.length&&(e.variations||[]).forEach(e=>{e.companionClickTrackingURLTemplates=Pe.joinArrayOfUniqueTemplateObjs(e.companionClickTrackingURLTemplates,n)})}),t.adVerifications&&(e.adVerifications=e.adVerifications.concat(t.adVerifications)),t.blockedAdCategories&&(e.blockedAdCategories=e.blockedAdCategories.concat(t.blockedAdCategories)),null!==(i=t.creatives)&&void 0!==i&&i.length){const i=t.creatives.filter(e=>{var t;return(null===(t=e.icons)||void 0===t?void 0:t.length)&&!e.mediaFiles.length});i.length&&(e.creatives=e.creatives.concat(i))}}};function Ve(e,t){const i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:t,adId:i,sequence:r,apiFramework:n}=ke(e);return{id:t,adId:i,sequence:r,apiFramework:n,type:"companion",required:null,variations:[]}}(t);return i.required=e.getAttribute("required")||null,i.variations=$e.childrenByName(e,"Companion").map(e=>{const t=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:e.id||null,adType:"companionAd",width:e.width||0,height:e.height||0,assetWidth:e.assetWidth||null,assetHeight:e.assetHeight||null,expandedWidth:e.expandedWidth||null,expandedHeight:e.expandedHeight||null,apiFramework:e.apiFramework||null,adSlotId:e.adSlotId||null,pxratio:e.pxratio||"1",renderingMode:e.renderingMode||"default",staticResources:[],htmlResources:[],iframeResources:[],adParameters:null,altText:null,companionClickThroughURLTemplate:null,companionClickTrackingURLTemplates:[],trackingEvents:{}}}($e.parseAttributes(e));t.htmlResources=$e.childrenByName(e,"HTMLResource").reduce((e,t)=>{const i=$e.parseNodeText(t);return i?e.concat(i):e},[]),t.iframeResources=$e.childrenByName(e,"IFrameResource").reduce((e,t)=>{const i=$e.parseNodeText(t);return i?e.concat(i):e},[]),t.staticResources=$e.childrenByName(e,"StaticResource").reduce((e,t)=>{const i=$e.parseNodeText(t);return i?e.concat({url:i,creativeType:t.getAttribute("creativeType")||null}):e},[]),t.altText=$e.parseNodeText($e.childByName(e,"AltText"))||null;const i=$e.childByName(e,"TrackingEvents");i&&$e.childrenByName(i,"Tracking").forEach(e=>{const i=e.getAttribute("event"),r=$e.parseNodeText(e);i&&r&&(Array.isArray(t.trackingEvents[i])||(t.trackingEvents[i]=[]),t.trackingEvents[i].push(r))}),t.companionClickTrackingURLTemplates=$e.childrenByName(e,"CompanionClickTracking").map(e=>({id:e.getAttribute("id")||null,url:$e.parseNodeText(e)})),t.companionClickThroughURLTemplate=$e.parseNodeText($e.childByName(e,"CompanionClickThrough"))||null;const r=$e.childByName(e,"AdParameters");return r&&(t.adParameters={value:$e.parseNodeText(r),xmlEncoded:r.getAttribute("xmlEncoded")||null}),t}),i}function Me(e,t){let i;const r=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:t,adId:i,sequence:r,apiFramework:n}=ke(e);return{id:t,adId:i,sequence:r,apiFramework:n,type:"linear",duration:0,skipDelay:null,mediaFiles:[],mezzanine:null,interactiveCreativeFile:null,closedCaptionFiles:[],videoClickThroughURLTemplate:null,videoClickTrackingURLTemplates:[],videoCustomClickURLTemplates:[],adParameters:null,icons:[],trackingEvents:{}}}(t);r.duration=$e.parseDuration($e.parseNodeText($e.childByName(e,"Duration")));const n=e.getAttribute("skipoffset");if(null==n)r.skipDelay=null;else if("%"===n.charAt(n.length-1)&&-1!==r.duration){const e=parseInt(n,10);r.skipDelay=r.duration*(e/100)}else r.skipDelay=$e.parseDuration(n);const s=$e.childByName(e,"VideoClicks");if(s){const e=$e.childByName(s,"ClickThrough");r.videoClickThroughURLTemplate=e?{id:e.getAttribute("id")||null,url:$e.parseNodeText(e)}:null,$e.childrenByName(s,"ClickTracking").forEach(e=>{r.videoClickTrackingURLTemplates.push({id:e.getAttribute("id")||null,url:$e.parseNodeText(e)})}),$e.childrenByName(s,"CustomClick").forEach(e=>{r.videoCustomClickURLTemplates.push({id:e.getAttribute("id")||null,url:$e.parseNodeText(e)})})}const o=$e.childByName(e,"AdParameters");o&&(r.adParameters={value:$e.parseNodeText(o),xmlEncoded:o.getAttribute("xmlEncoded")||null}),$e.childrenByName(e,"TrackingEvents").forEach(e=>{$e.childrenByName(e,"Tracking").forEach(e=>{let t=e.getAttribute("event");const n=$e.parseNodeText(e);if(t&&n){if("progress"===t){if(i=e.getAttribute("offset"),!i)return;t="%"===i.charAt(i.length-1)?"progress-".concat(i):"progress-".concat($e.parseDuration(i))}Array.isArray(r.trackingEvents[t])||(r.trackingEvents[t]=[]),r.trackingEvents[t].push(n)}})}),$e.childrenByName(e,"MediaFiles").forEach(e=>{$e.childrenByName(e,"MediaFile").forEach(e=>{r.mediaFiles.push(function(e){const t={id:null,fileURL:null,fileSize:0,deliveryType:"progressive",mimeType:null,mediaType:null,codec:null,bitrate:0,minBitrate:0,maxBitrate:0,width:0,height:0,apiFramework:null,scalable:null,maintainAspectRatio:null};t.id=e.getAttribute("id"),t.fileURL=$e.parseNodeText(e),t.deliveryType=e.getAttribute("delivery"),t.codec=e.getAttribute("codec"),t.mimeType=e.getAttribute("type"),t.mediaType=e.getAttribute("mediaType")||"2D",t.apiFramework=e.getAttribute("apiFramework"),t.fileSize=parseInt(e.getAttribute("fileSize")||0),t.bitrate=parseInt(e.getAttribute("bitrate")||0),t.minBitrate=parseInt(e.getAttribute("minBitrate")||0),t.maxBitrate=parseInt(e.getAttribute("maxBitrate")||0),t.width=parseInt(e.getAttribute("width")||0),t.height=parseInt(e.getAttribute("height")||0);const i=e.getAttribute("scalable");i&&"string"==typeof i&&(t.scalable=$e.parseBoolean(i));const r=e.getAttribute("maintainAspectRatio");return r&&"string"==typeof r&&(t.maintainAspectRatio=$e.parseBoolean(r)),t}(e))});const t=$e.childByName(e,"InteractiveCreativeFile");t&&(r.interactiveCreativeFile=function(e){const t=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:e.type||null,apiFramework:e.apiFramework||null,variableDuration:$e.parseBoolean(e.variableDuration),fileURL:null}}($e.parseAttributes(e));return t.fileURL=$e.parseNodeText(e),t}(t));const i=$e.childByName(e,"ClosedCaptionFiles");i&&$e.childrenByName(i,"ClosedCaptionFile").forEach(e=>{const t=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:e.type||null,language:e.language||null,fileURL:null}}($e.parseAttributes(e));t.fileURL=$e.parseNodeText(e),r.closedCaptionFiles.push(t)});const n=$e.childByName(e,"Mezzanine"),s=function(e){const t={};let i=!1;return["delivery","type","width","height"].forEach(r=>{e&&e.getAttribute(r)?t[r]=e.getAttribute(r):i=!0}),i?null:t}(n);if(s){const e={id:null,fileURL:null,delivery:null,codec:null,type:null,width:0,height:0,fileSize:0,mediaType:"2D"};e.id=n.getAttribute("id"),e.fileURL=$e.parseNodeText(n),e.delivery=s.delivery,e.codec=n.getAttribute("codec"),e.type=s.type,e.width=parseInt(s.width,10),e.height=parseInt(s.height,10),e.fileSize=parseInt(n.getAttribute("fileSize"),10),e.mediaType=n.getAttribute("mediaType")||"2D",r.mezzanine=e}});const a=$e.childByName(e,"Icons");return a&&$e.childrenByName(a,"Icon").forEach(e=>{r.icons.push(function(e){const t={program:null,height:0,width:0,xPosition:0,yPosition:0,apiFramework:null,offset:null,duration:0,type:null,staticResource:null,htmlResource:null,iframeResource:null,pxratio:"1",iconClickThroughURLTemplate:null,iconClickTrackingURLTemplates:[],iconViewTrackingURLTemplate:null,iconClickFallbackImages:[]};t.program=e.getAttribute("program"),t.height=parseInt(e.getAttribute("height")||0),t.width=parseInt(e.getAttribute("width")||0),t.xPosition=function(e){return-1!==["left","right"].indexOf(e)?e:parseInt(e||0)}(e.getAttribute("xPosition")),t.yPosition=function(e){return-1!==["top","bottom"].indexOf(e)?e:parseInt(e||0)}(e.getAttribute("yPosition")),t.apiFramework=e.getAttribute("apiFramework"),t.pxratio=e.getAttribute("pxratio")||"1",t.offset=$e.parseDuration(e.getAttribute("offset")),t.duration=$e.parseDuration(e.getAttribute("duration")),$e.childrenByName(e,"HTMLResource").forEach(e=>{t.type=e.getAttribute("creativeType")||"text/html",t.htmlResource=$e.parseNodeText(e)}),$e.childrenByName(e,"IFrameResource").forEach(e=>{t.type=e.getAttribute("creativeType")||0,t.iframeResource=$e.parseNodeText(e)}),$e.childrenByName(e,"StaticResource").forEach(e=>{t.type=e.getAttribute("creativeType")||0,t.staticResource=$e.parseNodeText(e)});const i=$e.childByName(e,"IconClicks");if(i){t.iconClickThroughURLTemplate=$e.parseNodeText($e.childByName(i,"IconClickThrough")),$e.childrenByName(i,"IconClickTracking").forEach(e=>{t.iconClickTrackingURLTemplates.push({id:e.getAttribute("id")||null,url:$e.parseNodeText(e)})});const e=$e.childByName(i,"IconClickFallbackImages");e&&$e.childrenByName(e,"IconClickFallbackImage").forEach(e=>{t.iconClickFallbackImages.push({url:$e.parseNodeText(e)||null,width:e.getAttribute("width")||null,height:e.getAttribute("height")||null})})}return t.iconViewTrackingURLTemplate=$e.parseNodeText($e.childByName(e,"IconViewTracking")),t}(e))}),r}function Fe(e,t){const i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:t,adId:i,sequence:r,apiFramework:n}=ke(e);return{id:t,adId:i,sequence:r,apiFramework:n,type:"nonlinear",variations:[],trackingEvents:{}}}(t);return $e.childrenByName(e,"TrackingEvents").forEach(e=>{let t,r;$e.childrenByName(e,"Tracking").forEach(e=>{t=e.getAttribute("event"),r=$e.parseNodeText(e),t&&r&&(Array.isArray(i.trackingEvents[t])||(i.trackingEvents[t]=[]),i.trackingEvents[t].push(r))})}),$e.childrenByName(e,"NonLinear").forEach(e=>{const t={id:null,width:0,height:0,expandedWidth:0,expandedHeight:0,scalable:!0,maintainAspectRatio:!0,minSuggestedDuration:0,apiFramework:"static",adType:"nonLinearAd",type:null,staticResource:null,htmlResource:null,iframeResource:null,nonlinearClickThroughURLTemplate:null,nonlinearClickTrackingURLTemplates:[],adParameters:null};t.id=e.getAttribute("id")||null,t.width=e.getAttribute("width"),t.height=e.getAttribute("height"),t.expandedWidth=e.getAttribute("expandedWidth"),t.expandedHeight=e.getAttribute("expandedHeight"),t.scalable=$e.parseBoolean(e.getAttribute("scalable")),t.maintainAspectRatio=$e.parseBoolean(e.getAttribute("maintainAspectRatio")),t.minSuggestedDuration=$e.parseDuration(e.getAttribute("minSuggestedDuration")),t.apiFramework=e.getAttribute("apiFramework"),$e.childrenByName(e,"HTMLResource").forEach(e=>{t.type=e.getAttribute("creativeType")||"text/html",t.htmlResource=$e.parseNodeText(e)}),$e.childrenByName(e,"IFrameResource").forEach(e=>{t.type=e.getAttribute("creativeType")||0,t.iframeResource=$e.parseNodeText(e)}),$e.childrenByName(e,"StaticResource").forEach(e=>{t.type=e.getAttribute("creativeType")||0,t.staticResource=$e.parseNodeText(e)});const r=$e.childByName(e,"AdParameters");r&&(t.adParameters={value:$e.parseNodeText(r),xmlEncoded:r.getAttribute("xmlEncoded")||null}),t.nonlinearClickThroughURLTemplate=$e.parseNodeText($e.childByName(e,"NonLinearClickThrough")),$e.childrenByName(e,"NonLinearClickTracking").forEach(e=>{t.nonlinearClickTrackingURLTemplates.push({id:e.getAttribute("id")||null,url:$e.parseNodeText(e)})}),i.variations.push(t)}),i}function qe(e){const t=[];return e.forEach(e=>{const i=ze(e);i&&t.push(i)}),t}function ze(e){if("#comment"===e.nodeName)return null;const t={name:null,value:null,attributes:{},children:[]},i=e.attributes,r=e.childNodes;if(t.name=e.nodeName,e.attributes)for(const e in i)if(i.hasOwnProperty(e)){const r=i[e];r.nodeName&&r.nodeValue&&(t.attributes[r.nodeName]=r.nodeValue)}for(const e in r)if(r.hasOwnProperty(e)){const i=ze(r[e]);i&&t.children.push(i)}if(0===t.children.length||1===t.children.length&&["#cdata-section","#text"].indexOf(t.children[0].name)>=0){const i=$e.parseNodeText(e);""!==i&&(t.value=i),t.children=[]}return null===(n=t).value&&0===Object.keys(n.attributes).length&&0===n.children.length?null:t;var n}function Be(e){return e.getAttribute("AdID")||e.getAttribute("adID")||e.getAttribute("adId")||null}const He={Wrapper:{subElements:["VASTAdTagURI","Impression"]},BlockedAdCategories:{attributes:["authority"]},InLine:{subElements:["AdSystem","AdTitle","Impression","AdServingId","Creatives"]},Category:{attributes:["authority"]},Pricing:{attributes:["model","currency"]},Verification:{oneOfinLineResources:["JavaScriptResource","ExecutableResource"],attributes:["vendor"]},UniversalAdId:{attributes:["idRegistry"]},JavaScriptResource:{attributes:["apiFramework","browserOptional"]},ExecutableResource:{attributes:["apiFramework","type"]},Tracking:{attributes:["event"]},Creatives:{subElements:["Creative"]},Creative:{subElements:["UniversalAdId"]},Linear:{subElements:["MediaFiles","Duration"]},MediaFiles:{subElements:["MediaFile"]},MediaFile:{attributes:["delivery","type","width","height"]},Mezzanine:{attributes:["delivery","type","width","height"]},NonLinear:{oneOfinLineResources:["StaticResource","IFrameResource","HTMLResource"],attributes:["width","height"]},Companion:{oneOfinLineResources:["StaticResource","IFrameResource","HTMLResource"],attributes:["width","height"]},StaticResource:{attributes:["creativeType"]},Icons:{subElements:["Icon"]},Icon:{oneOfinLineResources:["StaticResource","IFrameResource","HTMLResource"]}};function _e(e,t){let{name:i,parentName:r,attributes:n,subElements:s,oneOfResources:o}=e,a="Element '".concat(i,"'");a+=n?" missing required attribute(s) '".concat(n.join(", "),"' "):s?" missing required sub element(s) '".concat(s.join(", "),"' "):o?" must provide one of the following '".concat(o.join(", "),"' "):" is empty",t("VAST-warning",{message:a,parentElement:r,specVersion:4.1})}const We=function e(t,i,r){if(t&&t.nodeName)if("InLine"===t.nodeName&&(r=!0),function(e,t){if(!He[e.nodeName]||!He[e.nodeName].attributes)return;const i=He[e.nodeName].attributes.filter(t=>!e.getAttribute(t));i.length>0&&_e({name:e.nodeName,parentName:e.parentNode.nodeName,attributes:i},t)}(t,i),function(e){return e.children&&0!==e.children.length}(t)){!function(e,t,i){const r=He[e.nodeName],n=!i&&"Wrapper"!==e.nodeName;if(r&&!n){if(r.subElements){const i=r.subElements.filter(t=>!$e.childByName(e,t));i.length>0&&_e({name:e.nodeName,parentName:e.parentNode.nodeName,subElements:i},t)}i&&r.oneOfinLineResources&&(r.oneOfinLineResources.some(t=>$e.childByName(e,t))||_e({name:e.nodeName,parentName:e.parentNode.nodeName,oneOfResources:r.oneOfinLineResources},t))}}(t,i,r);for(let n=0;n<t.children.length;n++)e(t.children[n],i,r)}else 0===$e.parseNodeText(t).length&&_e({name:t.nodeName,parentName:t.parentNode.nodeName},i)};function je(e,t){let{allowMultipleAds:i,followAdditionalWrappers:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=Array.from(e.childNodes).filter(e=>{const t=e.nodeName.toLowerCase();return"inline"===t||!1!==r&&"wrapper"===t});for(const r of n){if($e.copyNodeAttribute("id",e,r),$e.copyNodeAttribute("sequence",e,r),$e.copyNodeAttribute("adType",e,r),"Wrapper"===r.nodeName)return{ad:Ke(r,t),type:"WRAPPER"};if("InLine"===r.nodeName)return{ad:Ge(r,t,{allowMultipleAds:i}),type:"INLINE"};const n=r.nodeName.toLowerCase();t("VAST-warning",{message:"<".concat(r.nodeName,"inline"===n?"> must be written <InLine>":"> must be written <Wrapper>"),wrongNode:r})}}function Ge(e,t){let{allowMultipleAds:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return!1===i&&e.getAttribute("sequence")?null:Ze(e,t)}function Ze(e,t){let i=[];t&&We(e,t);const r=Array.from(e.childNodes),n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:e.id||null,sequence:e.sequence||null,adType:e.adType||null,adServingId:null,categories:[],expires:null,viewableImpression:[],system:null,title:null,description:null,advertiser:null,pricing:null,survey:null,errorURLTemplates:[],impressionURLTemplates:[],creatives:[],extensions:[],adVerifications:[],blockedAdCategories:[],followAdditionalWrappers:!0,allowMultipleAds:!1,fallbackOnNoAd:null}}($e.parseAttributes(e));return r.forEach(e=>{switch(e.nodeName){case"Error":n.errorURLTemplates.push($e.parseNodeText(e));break;case"Impression":n.impressionURLTemplates.push({id:e.getAttribute("id")||null,url:$e.parseNodeText(e)});break;case"Creatives":n.creatives=function(e){const t=[];return e.forEach(e=>{const i={id:e.getAttribute("id")||null,adId:Be(e),sequence:e.getAttribute("sequence")||null,apiFramework:e.getAttribute("apiFramework")||null},r=[];let n;$e.childrenByName(e,"UniversalAdId").forEach(e=>{const t={idRegistry:e.getAttribute("idRegistry")||"unknown",value:$e.parseNodeText(e)};r.push(t)});const s=$e.childByName(e,"CreativeExtensions");s&&(n=qe($e.childrenByName(s,"CreativeExtension")));for(const s in e.childNodes){const o=e.childNodes[s];let a;switch(o.nodeName){case"Linear":a=Me(o,i);break;case"NonLinearAds":a=Fe(o,i);break;case"CompanionAds":a=Ve(o,i)}a&&(r&&(a.universalAdIds=r),n&&(a.creativeExtensions=n),t.push(a))}}),t}($e.childrenByName(e,"Creative"));break;case"Extensions":{const t=$e.childrenByName(e,"Extension");n.extensions=qe(t),n.adVerifications.length||(i=function(e){let t=null,i=[];return e.some(e=>t=$e.childByName(e,"AdVerifications")),t&&(i=Qe($e.childrenByName(t,"Verification"))),i}(t));break}case"AdVerifications":n.adVerifications=Qe($e.childrenByName(e,"Verification"));break;case"AdSystem":n.system={value:$e.parseNodeText(e),version:e.getAttribute("version")||null};break;case"AdTitle":n.title=$e.parseNodeText(e);break;case"AdServingId":n.adServingId=$e.parseNodeText(e);break;case"Category":n.categories.push({authority:e.getAttribute("authority")||null,value:$e.parseNodeText(e)});break;case"Expires":n.expires=parseInt($e.parseNodeText(e),10);break;case"ViewableImpression":n.viewableImpression.push(function(e){const t=(e,t)=>{const i=$e.parseNodeText(t);return i&&e.push(i),e};return{id:e.getAttribute("id")||null,viewable:$e.childrenByName(e,"Viewable").reduce(t,[]),notViewable:$e.childrenByName(e,"NotViewable").reduce(t,[]),viewUndetermined:$e.childrenByName(e,"ViewUndetermined").reduce(t,[])}}(e));break;case"Description":n.description=$e.parseNodeText(e);break;case"Advertiser":n.advertiser={id:e.getAttribute("id")||null,value:$e.parseNodeText(e)};break;case"Pricing":n.pricing={value:$e.parseNodeText(e),model:e.getAttribute("model")||null,currency:e.getAttribute("currency")||null};break;case"Survey":n.survey={value:$e.parseNodeText(e),type:e.getAttribute("type")||null};break;case"BlockedAdCategories":n.blockedAdCategories.push({authority:e.getAttribute("authority")||null,value:$e.parseNodeText(e)})}}),i.length&&(n.adVerifications=n.adVerifications.concat(i)),n}function Ke(e,t){const i=Ze(e,t),r=e.getAttribute("followAdditionalWrappers"),n=e.getAttribute("allowMultipleAds"),s=e.getAttribute("fallbackOnNoAd");i.followAdditionalWrappers=!r||$e.parseBoolean(r),i.allowMultipleAds=!!n&&$e.parseBoolean(n),i.fallbackOnNoAd=s?$e.parseBoolean(s):null;let o=$e.childByName(e,"VASTAdTagURI");if(o?i.nextWrapperURL=$e.parseNodeText(o):(o=$e.childByName(e,"VASTAdTagURL"),o&&(i.nextWrapperURL=$e.parseNodeText($e.childByName(o,"URL")))),i.creatives.forEach(e=>{if(["linear","nonlinear"].includes(e.type)){if(e.trackingEvents){i.trackingEvents||(i.trackingEvents={}),i.trackingEvents[e.type]||(i.trackingEvents[e.type]={});for(const t in e.trackingEvents){const r=e.trackingEvents[t];Array.isArray(i.trackingEvents[e.type][t])||(i.trackingEvents[e.type][t]=[]),r.forEach(r=>{i.trackingEvents[e.type][t].push(r)})}}e.videoClickTrackingURLTemplates&&(Array.isArray(i.videoClickTrackingURLTemplates)||(i.videoClickTrackingURLTemplates=[]),e.videoClickTrackingURLTemplates.forEach(e=>{i.videoClickTrackingURLTemplates.push(e)})),e.videoClickThroughURLTemplate&&(i.videoClickThroughURLTemplate=e.videoClickThroughURLTemplate),e.videoCustomClickURLTemplates&&(Array.isArray(i.videoCustomClickURLTemplates)||(i.videoCustomClickURLTemplates=[]),e.videoCustomClickURLTemplates.forEach(e=>{i.videoCustomClickURLTemplates.push(e)}))}}),i.nextWrapperURL)return i}function Qe(e){const t=[];return e.forEach(e=>{const i={resource:null,vendor:null,browserOptional:!1,apiFramework:null,type:null,parameters:null,trackingEvents:{}},r=Array.from(e.childNodes);$e.assignAttributes(e.attributes,i),r.forEach(e=>{let{nodeName:t,textContent:r,attributes:n}=e;switch(t){case"JavaScriptResource":case"ExecutableResource":i.resource=r.trim(),$e.assignAttributes(n,i);break;case"VerificationParameters":i.parameters=r.trim()}});const n=$e.childByName(e,"TrackingEvents");n&&$e.childrenByName(n,"Tracking").forEach(e=>{const t=e.getAttribute("event"),r=$e.parseNodeText(e);t&&r&&(Array.isArray(i.trackingEvents[t])||(i.trackingEvents[t]=[]),i.trackingEvents[t].push(r))}),t.push(i)}),t}class Xe{constructor(){this._handlers=[]}on(e,t){if("function"!=typeof t)throw new TypeError("The handler argument must be of type Function. Received type ".concat(typeof t));if(!e)throw new TypeError("The event argument must be of type String. Received type ".concat(typeof e));return this._handlers.push({event:e,handler:t}),this}once(e,t){return this.on(e,function(e,t,i){const r={fired:!1,wrapFn:void 0};function n(){r.fired||(e.off(t,r.wrapFn),r.fired=!0,i.bind(e)(...arguments))}return r.wrapFn=n,n}(this,e,t))}off(e,t){return this._handlers=this._handlers.filter(i=>i.event!==e||i.handler!==t),this}emit(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];let n=!1;return this._handlers.forEach(t=>{"*"===t.event&&(n=!0,t.handler(e,...i)),t.event===e&&(n=!0,t.handler(...i))}),n}removeAllListeners(e){return e?(this._handlers=this._handlers.filter(t=>t.event!==e),this):(this._handlers=[],this)}listenerCount(e){return this._handlers.filter(t=>t.event===e).length}listeners(e){return this._handlers.reduce((t,i)=>(i.event===e&&t.push(i.handler),t),[])}eventNames(){return this._handlers.map(e=>e.event)}}let Ye=0,Je=0;const et=(e,t)=>{!e||!t||e<=0||t<=0||(Je=(Je*Ye+8*e/t)/++Ye)},tt={ERRORCODE:900,extensions:[]},it="VAST response version not supported";class rt extends Xe{constructor(){let{fetcher:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this.maxWrapperDepth=null,this.rootErrorURLTemplates=[],this.errorURLTemplates=[],this.remainingAds=[],this.parsingOptions={},this.fetcher=e||null}trackVastError(e,t){for(var i=arguments.length,r=new Array(i>2?i-2:0),n=2;n<i;n++)r[n-2]=arguments[n];this.emit("VAST-error",Object.assign({},tt,t,...r)),Pe.track(e,t)}getErrorURLTemplates(){return this.rootErrorURLTemplates.concat(this.errorURLTemplates)}getEstimatedBitrate(){return Je}initParsingStatus(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.maxWrapperDepth=e.wrapperLimit||10,this.parsingOptions={allowMultipleAds:e.allowMultipleAds},this.rootURL="",this.resetParsingStatus(),et(e.byteLength,e.requestDuration)}resetParsingStatus(){this.errorURLTemplates=[],this.rootErrorURLTemplates=[],this.vastVersion=null}getRemainingAds(e){if(0===this.remainingAds.length)return Promise.reject(new Error("No more ads are available for the given VAST"));const t=e?this.remainingAds:[this.remainingAds.shift()];return this.errorURLTemplates=[],this.resolveAds(t,{wrapperDepth:0,url:this.rootURL}).then(e=>this.buildVASTResponse(e))}parseVAST(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.initParsingStatus(t),t.isRootVAST=!0,this.parse(e,t).then(e=>this.buildVASTResponse(e))}buildVASTResponse(e){const t=function(e){let{ads:t,errorURLTemplates:i,version:r}=e;return{ads:t||[],errorURLTemplates:i||[],version:r||null}}({ads:e,errorURLTemplates:this.getErrorURLTemplates(),version:this.vastVersion});return this.completeWrapperResolving(t),t}parseVastXml(e,t){let{isRootVAST:i=!1,url:r=null,wrapperDepth:n=0,allowMultipleAds:s,followAdditionalWrappers:o}=t;if(!e||!e.documentElement||"VAST"!==e.documentElement.nodeName){var a;this.emit("VAST-ad-parsed",{type:"ERROR",url:r,wrapperDepth:n});const t="VideoAdServingTemplate"===(null==e||null===(a=e.documentElement)||void 0===a?void 0:a.nodeName);throw new Error(t?it:"Invalid VAST XMLDocument")}const l=[],d=e.documentElement.childNodes,c=e.documentElement.getAttribute("version");i&&c&&(this.vastVersion=c);for(const e in d){const t=d[e];if("Error"===t.nodeName){const e=$e.parseNodeText(t);i?this.rootErrorURLTemplates.push(e):this.errorURLTemplates.push(e)}else if("Ad"===t.nodeName){if(this.vastVersion&&parseFloat(this.vastVersion)<3)s=!0;else if(!1===s&&l.length>1)break;const e=je(t,this.emit.bind(this),{allowMultipleAds:s,followAdditionalWrappers:o});e.ad?(l.push(e.ad),this.emit("VAST-ad-parsed",{type:e.type,url:r,wrapperDepth:n,adIndex:l.length-1,vastVersion:c})):this.trackVastError(this.getErrorURLTemplates(),{ERRORCODE:101})}}return l}parse(e){let{url:t=null,resolveAll:i=!0,wrapperSequence:r=null,previousUrl:n=null,wrapperDepth:s=0,isRootVAST:o=!1,followAdditionalWrappers:a,allowMultipleAds:l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},d=[];this.vastVersion&&parseFloat(this.vastVersion)<3&&o&&(l=!0);try{d=this.parseVastXml(e,{isRootVAST:o,url:t,wrapperDepth:s,allowMultipleAds:l,followAdditionalWrappers:a})}catch(e){return Promise.reject(e)}if(1===d.length&&null!=r&&(d[0].sequence=r),!1===i){const e=$e.getSortedAdPods(d),t=$e.getStandAloneAds(d);e.length?d=e:t.length&&(d=[t.shift()]),this.remainingAds=t}return this.resolveAds(d,{wrapperDepth:s,previousUrl:n,url:t})}resolveAds(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],{wrapperDepth:t,previousUrl:i,url:r}=arguments.length>1?arguments[1]:void 0;const n=[];return i=r,e.forEach(e=>{const r=this.resolveWrappers(e,t,i);n.push(r)}),Promise.all(n).then(e=>Pe.flatten(e))}resolveWrappers(e,t,i){const r={...e};return new Promise(e=>{var n;if(t++,!r.nextWrapperURL)return delete r.nextWrapperURL,e(r);if(!this.fetcher)return r.VASTAdTagURI=r.nextWrapperURL,delete r.nextWrapperURL,e(r);if(t>=this.maxWrapperDepth)return r.errorCode=302,delete r.nextWrapperURL,e(r);r.nextWrapperURL=$e.resolveVastAdTagURI(r.nextWrapperURL,i);const s=null!==(n=this.parsingOptions.allowMultipleAds)&&void 0!==n?n:r.allowMultipleAds,o=r.sequence;this.fetcher.fetchVAST({url:r.nextWrapperURL,emitter:this.emit.bind(this),maxWrapperDepth:this.maxWrapperDepth}).then(n=>this.parse(n,{url:r.nextWrapperURL,previousUrl:i,wrapperSequence:o,wrapperDepth:t,followAdditionalWrappers:r.followAdditionalWrappers,allowMultipleAds:s}).then(t=>{if(delete r.nextWrapperURL,0===t.length)return r.creatives=[],e(r);t.forEach(e=>{e&&$e.mergeWrapperAdData(e,r)}),e(t)})).catch(t=>{r.errorCode=t.message===it?102:301,r.errorMessage=t.message,e(r)})})}completeWrapperResolving(e){if(0===e.ads.length)this.trackVastError(e.errorURLTemplates,{ERRORCODE:303});else for(let t=e.ads.length-1;t>=0;t--){const i=e.ads[t],r=!i.creatives.some(e=>{var t;return(null===(t=e.mediaFiles)||void 0===t?void 0:t.length)>0});!i.errorCode&&!r||i.VASTAdTagURI||(this.trackVastError(i.errorURLTemplates.concat(e.errorURLTemplates),{ERRORCODE:i.errorCode||303},{ERRORMESSAGE:i.errorMessage||""},{extensions:i.extensions},{system:i.system}),e.ads.splice(t,1))}}}let nt=null;const st={data:{},length:0,getItem(e){return this.data[e]},setItem(e,t){this.data[e]=t,this.length=Object.keys(this.data).length},removeItem(e){delete this.data[e],this.length=Object.keys(this.data).length},clear(){this.data={},this.length=0}};class ot{constructor(){this.storage=this.initStorage()}initStorage(){if(nt)return nt;try{nt="undefined"!=typeof window&&null!==window?window.localStorage||window.sessionStorage:null}catch(e){nt=null}return nt&&!this.isStorageDisabled(nt)||(nt=st,nt.clear()),nt}isStorageDisabled(e){const t="__VASTStorage__";try{if(e.setItem(t,t),e.getItem(t)!==t)return e.removeItem(t),!0}catch(e){return!0}return e.removeItem(t),!1}getItem(e){return this.storage.getItem(e)}setItem(e,t){return this.storage.setItem(e,t)}removeItem(e){return this.storage.removeItem(e)}clear(){return this.storage.clear()}}const at=12e4,lt={get:async function(e,t){try{const i=new AbortController,r=setTimeout(()=>{throw i.abort(),new Error("URLHandler: Request timed out after ".concat(t.timeout||at," ms (408)"))},t.timeout||at),n=await fetch(e,{...t,signal:i.signal,credentials:t.withCredentials?"include":"omit"}).finally(()=>{clearTimeout(r)}),s=function(e){return Pe.isBrowserEnvironment()&&"https:"===window.location.protocol&&e.url.includes("http://")?"URLHandler: Cannot go from HTTPS to HTTP.":200===e.status&&e.ok?null:"URLHandler: ".concat(e.statusText," (").concat(e.status,")")}(n);return s?{error:new Error(s),statusCode:n.status}:async function(e){const t=await e.text();let i;return i=Pe.isBrowserEnvironment()?new DOMParser:new((await Promise.resolve().then(function(){return Gt})).DOMParser),{xml:i.parseFromString(t,"text/xml"),details:{byteLength:t.length,statusCode:e.status,rawXml:t}}}(n)}catch(e){return{error:e,statusCode:"AbortError"===e.name?408:null}}}};class dt{constructor(){this.URLTemplateFilters=[]}setOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.urlHandler=e.urlHandler||e.urlhandler||lt,this.fetchingOptions={timeout:e.timeout||at,withCredentials:Boolean(e.withCredentials)}}addURLTemplateFilter(e){"function"==typeof e&&this.URLTemplateFilters.push(e)}removeLastURLTemplateFilter(){this.URLTemplateFilters.pop()}countURLTemplateFilters(){return this.URLTemplateFilters.length}clearURLTemplateFilters(){this.URLTemplateFilters=[]}async fetchVAST(e){var t;let{url:i,maxWrapperDepth:r,emitter:n,wrapperDepth:s=0,previousUrl:o=null,wrapperAd:a=null}=e;const l=Date.now();this.URLTemplateFilters.forEach(e=>{i=e(i)}),n("VAST-resolving",{url:i,previousUrl:o,wrapperDepth:s,maxWrapperDepth:r,timeout:this.fetchingOptions.timeout,wrapperAd:a});const d=await this.urlHandler.get(i,this.fetchingOptions),c=Math.round(Date.now()-l);if(n("VAST-resolved",{url:i,previousUrl:o,wrapperDepth:s,error:(null==d?void 0:d.error)||null,duration:c,statusCode:(null==d?void 0:d.statusCode)||null,...null==d?void 0:d.details}),et(null==d||null===(t=d.details)||void 0===t?void 0:t.byteLength,c),d.error)throw new Error(d.error);return d.xml}}class ct{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new ot;this.cappingFreeLunch=e,this.cappingMinimumTimeInterval=t,this.fetcher=new dt,this.vastParser=new rt({fetcher:this.fetcher}),this.storage=i,void 0===this.lastSuccessfulAd&&(this.lastSuccessfulAd=0),void 0===this.totalCalls&&(this.totalCalls=0),void 0===this.totalCallsTimeout&&(this.totalCallsTimeout=0)}addURLTemplateFilter(e){this.fetcher.addURLTemplateFilter(e)}removeLastURLTemplateFilter(){this.fetcher.removeLastURLTemplateFilter()}countURLTemplateFilters(){return this.fetcher.countURLTemplateFilters()}clearURLTemplateFilters(){this.fetcher.clearURLTemplateFilters()}getParser(){return this.vastParser}get lastSuccessfulAd(){return this.storage.getItem("vast-client-last-successful-ad")}set lastSuccessfulAd(e){this.storage.setItem("vast-client-last-successful-ad",e)}get totalCalls(){return this.storage.getItem("vast-client-total-calls")}set totalCalls(e){this.storage.setItem("vast-client-total-calls",e)}get totalCallsTimeout(){return this.storage.getItem("vast-client-total-calls-timeout")}set totalCallsTimeout(e){this.storage.setItem("vast-client-total-calls-timeout",e)}hasRemainingAds(){return this.vastParser.remainingAds.length>0}getNextAds(e){return this.vastParser.getRemainingAds(e)}parseVAST(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.fetcher.setOptions(t),this.vastParser.parseVAST(e,t)}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=Date.now();return t.hasOwnProperty("resolveAll")||(t.resolveAll=!1),this.totalCallsTimeout<i?(this.totalCalls=1,this.totalCallsTimeout=i+36e5):this.totalCalls++,new Promise((r,n)=>{if(this.cappingFreeLunch>=this.totalCalls)return n(new Error("VAST call canceled  FreeLunch capping not reached yet ".concat(this.totalCalls,"/").concat(this.cappingFreeLunch)));const s=i-this.lastSuccessfulAd;if(s<0)this.lastSuccessfulAd=0;else if(s<this.cappingMinimumTimeInterval)return n(new Error("VAST call canceled  (".concat(this.cappingMinimumTimeInterval,")ms minimum interval reached")));this.vastParser.initParsingStatus(t),this.fetcher.setOptions(t),this.vastParser.rootURL=e,this.fetcher.fetchVAST({url:e,emitter:this.vastParser.emit.bind(this.vastParser),maxWrapperDepth:this.vastParser.maxWrapperDepth}).then(i=>(t.previousUrl=e,t.isRootVAST=!0,t.url=e,this.vastParser.parse(i,t).then(e=>{const t=this.vastParser.buildVASTResponse(e);r(t)}))).catch(e=>n(e))})}}class ht extends Xe{constructor(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]&&arguments[4];super(),this.ad=t,this.creative=i,this.variation=r,this.muted=n,this.impressed=!1,this.skippable=!1,this.trackingEvents={},this.trackedProgressEvents=[],this.lastPercentage=0,this._alreadyTriggeredQuartiles={},this.emitAlwaysEvents=["creativeView","start","firstQuartile","midpoint","thirdQuartile","complete","resume","pause","rewind","skip","closeLinear","close"];for(const e in this.creative.trackingEvents){const t=this.creative.trackingEvents[e];this.trackingEvents[e]=t.slice(0)}!function(e){return"linear"===e.type}(this.creative)?this._initVariationTracking():this._initLinearTracking(),e&&this.on("start",()=>{e.lastSuccessfulAd=Date.now()})}_initLinearTracking(){this.linear=!0,this.skipDelay=this.creative.skipDelay,this.setDuration(this.creative.duration),this.clickThroughURLTemplate=this.creative.videoClickThroughURLTemplate,this.clickTrackingURLTemplates=this.creative.videoClickTrackingURLTemplates}_initVariationTracking(){if(this.linear=!1,this.skipDelay=-1,this.variation){for(const e in this.variation.trackingEvents){const t=this.variation.trackingEvents[e];this.trackingEvents[e]?this.trackingEvents[e]=this.trackingEvents[e].concat(t.slice(0)):this.trackingEvents[e]=t.slice(0)}"nonLinearAd"===this.variation.adType?(this.clickThroughURLTemplate=this.variation.nonlinearClickThroughURLTemplate,this.clickTrackingURLTemplates=this.variation.nonlinearClickTrackingURLTemplates,this.setDuration(this.variation.minSuggestedDuration)):function(e){return"companionAd"===e.adType}(this.variation)&&(this.clickThroughURLTemplate=this.variation.companionClickThroughURLTemplate,this.clickTrackingURLTemplates=this.variation.companionClickTrackingURLTemplates)}}setDuration(e){Pe.isValidTimeValue(e)?(this.assetDuration=e,this.quartiles={firstQuartile:Math.round(25*this.assetDuration)/100,midpoint:Math.round(50*this.assetDuration)/100,thirdQuartile:Math.round(75*this.assetDuration)/100}):this.emit("TRACKER-error",{message:"the duration provided is not valid. duration: ".concat(e)})}setProgress(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!Pe.isValidTimeValue(e)||"object"!=typeof t)return void this.emit("TRACKER-error",{message:"One given setProgress parameter has the wrong type. progress: ".concat(e,", macros: ").concat(Pe.formatMacrosValues(t))});const r=this.skipDelay||-1;if(-1===r||this.skippable||(r>e?this.emit("skip-countdown",r-e):(this.skippable=!0,this.emit("skip-countdown",0))),this.assetDuration>0){const r=Math.round(e/this.assetDuration*100),n=[];if(e>0){n.push("start");for(let e=this.lastPercentage;e<r;e++)n.push("progress-".concat(e+1,"%"));n.push("progress-".concat(e));for(const t in this.quartiles)this.isQuartileReached(t,this.quartiles[t],e)&&(n.push(t),this._alreadyTriggeredQuartiles[t]=!0);this.lastPercentage=r}n.forEach(e=>{this.track(e,{macros:t,once:i})}),e<this.progress&&(this.track("rewind",{macros:t}),this.trackedProgressEvents&&this.trackedProgressEvents.splice(0))}this.progress=e}isQuartileReached(e,t,i){let r=!1;return t<=i&&!this._alreadyTriggeredQuartiles[e]&&(r=!0),r}setMuted(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"boolean"==typeof e&&"object"==typeof t?(this.muted!==e&&this.track(e?"mute":"unmute",{macros:t}),this.muted=e):this.emit("TRACKER-error",{message:"One given setMuted parameter has the wrong type. muted: ".concat(e,", macros: ").concat(Pe.formatMacrosValues(t))})}setPaused(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"boolean"==typeof e&&"object"==typeof t?(this.paused!==e&&this.track(e?"pause":"resume",{macros:t}),this.paused=e):this.emit("TRACKER-error",{message:"One given setPaused parameter has the wrong type. paused: ".concat(e,", macros: ").concat(Pe.formatMacrosValues(t))})}setFullscreen(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"boolean"==typeof e&&"object"==typeof t?(this.fullscreen!==e&&this.track(e?"fullscreen":"exitFullscreen",{macros:t}),this.fullscreen=e):this.emit("TRACKER-error",{message:"One given setFullScreen parameter has the wrong type. fullscreen: ".concat(e,", macros: ").concat(Pe.formatMacrosValues(t))})}setExpand(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"boolean"==typeof e&&"object"==typeof t?(this.expanded!==e&&(this.track(e?"expand":"collapse",{macros:t}),this.track(e?"playerExpand":"playerCollapse",{macros:t})),this.expanded=e):this.emit("TRACKER-error",{message:"One given setExpand parameter has the wrong type. expanded: ".concat(e,", macros: ").concat(Pe.formatMacrosValues(t))})}setSkipDelay(e){Pe.isValidTimeValue(e)?this.skipDelay=e:this.emit("TRACKER-error",{message:"setSkipDelay parameter does not have a valid value. duration: ".concat(e)})}trackImpression(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"==typeof e?this.impressed||(this.impressed=!0,this.trackURLs(this.ad.impressionURLTemplates,e),this.track("creativeView",{macros:e})):this.emit("TRACKER-error",{message:"trackImpression parameter has the wrong type. macros: ".concat(e)})}trackViewableImpression(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"==typeof e?this.ad.viewableImpression.forEach(t=>{this.trackURLs(t.viewable,e)}):this.emit("TRACKER-error",{message:"trackViewableImpression given macros has the wrong type. macros: ".concat(e)})}trackNotViewableImpression(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"==typeof e?this.ad.viewableImpression.forEach(t=>{this.trackURLs(t.notViewable,e)}):this.emit("TRACKER-error",{message:"trackNotViewableImpression given macros has the wrong type. macros: ".concat(e)})}trackUndeterminedImpression(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"==typeof e?this.ad.viewableImpression.forEach(t=>{this.trackURLs(t.viewUndetermined,e)}):this.emit("TRACKER-error",{message:"trackUndeterminedImpression given macros has the wrong type. macros: ".concat(e)})}error(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"object"==typeof e&&"boolean"==typeof t?this.trackURLs(this.ad.errorURLTemplates,e,{isCustomCode:t}):this.emit("TRACKER-error",{message:"One given error parameter has the wrong type. macros: ".concat(Pe.formatMacrosValues(e),", isCustomCode: ").concat(t)})}errorWithCode(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"string"==typeof e&&"boolean"==typeof t?(this.error({ERRORCODE:e},t),console.log("The method errorWithCode is deprecated, please use vast tracker error method instead")):this.emit("TRACKER-error",{message:"One given errorWithCode parameter has the wrong type. errorCode: ".concat(e,", isCustomCode: ").concat(t)})}complete(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"==typeof e?this.track("complete",{macros:e}):this.emit("TRACKER-error",{message:"complete given macros has the wrong type. macros: ".concat(e)})}notUsed(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"==typeof e?(this.track("notUsed",{macros:e}),this.trackingEvents=[]):this.emit("TRACKER-error",{message:"notUsed given macros has the wrong type. macros: ".concat(e)})}otherAdInteraction(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"==typeof e?this.track("otherAdInteraction",{macros:e}):this.emit("TRACKER-error",{message:"otherAdInteraction given macros has the wrong type. macros: ".concat(e)})}acceptInvitation(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"==typeof e?this.track("acceptInvitation",{macros:e}):this.emit("TRACKER-error",{message:"acceptInvitation given macros has the wrong type. macros: ".concat(e)})}adExpand(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"==typeof e?this.track("adExpand",{macros:e}):this.emit("TRACKER-error",{message:"adExpand given macros has the wrong type. macros: ".concat(e)})}adCollapse(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"==typeof e?this.track("adCollapse",{macros:e}):this.emit("TRACKER-error",{message:"adCollapse given macros has the wrong type. macros: ".concat(e)})}minimize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"==typeof e?this.track("minimize",{macros:e}):this.emit("TRACKER-error",{message:"minimize given macros has the wrong type. macros: ".concat(e)})}verificationNotExecuted(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"!=typeof e||"object"!=typeof t)return void this.emit("TRACKER-error",{message:"One given verificationNotExecuted parameter has to wrong type. vendor: ".concat(e,", macros: ").concat(Pe.formatMacrosValues(t))});if(!this.ad||!this.ad.adVerifications||!this.ad.adVerifications.length)throw new Error("No adVerifications provided");if(!e)throw new Error("No vendor provided, unable to find associated verificationNotExecuted");const i=this.ad.adVerifications.find(t=>t.vendor===e);if(!i)throw new Error("No associated verification element found for vendor: ".concat(e));const r=i.trackingEvents;if(r&&r.verificationNotExecuted){const e=r.verificationNotExecuted;this.trackURLs(e,t),this.emit("verificationNotExecuted",{trackingURLTemplates:e})}}overlayViewDuration(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"string"==typeof e&&"object"==typeof t?(t.ADPLAYHEAD=e,this.track("overlayViewDuration",{macros:t})):this.emit("TRACKER-error",{message:"One given overlayViewDuration parameters has the wrong type. formattedDuration: ".concat(e,", macros: ").concat(Pe.formatMacrosValues(t))})}close(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"==typeof e?this.track(this.linear?"closeLinear":"close",{macros:e}):this.emit("TRACKER-error",{message:"close given macros has the wrong type. macros: ".concat(e)})}skip(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"==typeof e?this.track("skip",{macros:e}):this.emit("TRACKER-error",{message:"skip given macros has the wrong type. macros: ".concat(e)})}load(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"object"==typeof e?this.track("loaded",{macros:e}):this.emit("TRACKER-error",{message:"load given macros has the wrong type. macros: ".concat(e)})}click(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null!==e&&"string"!=typeof e||"object"!=typeof t)return void this.emit("TRACKER-error",{message:"One given click parameter has the wrong type. fallbackClickThroughURL: ".concat(e,", macros: ").concat(Pe.formatMacrosValues(t))});this.clickTrackingURLTemplates&&this.clickTrackingURLTemplates.length&&this.trackURLs(this.clickTrackingURLTemplates,t);const i=this.clickThroughURLTemplate||e,r={...t};if(i){this.progress&&(r.ADPLAYHEAD=this.progressFormatted());const e=Pe.resolveURLTemplates([i],r)[0];this.emit("clickthrough",e)}}trackProgressEvents(e,t,i){const r=parseFloat(e.split("-")[1]);Object.entries(this.trackingEvents).filter(e=>{let[t]=e;return t.startsWith("progress-")}).map(e=>{let[t,i]=e;return{name:t,time:parseFloat(t.split("-")[1]),urls:i}}).filter(e=>{let{time:t}=e;return t<=r&&t>this.progress}).forEach(e=>{let{name:r,urls:n}=e;!i&&this.trackedProgressEvents.includes(r)||(this.emit(r,{trackingURLTemplates:n}),this.trackURLs(n,t),i?delete this.trackingEvents[r]:this.trackedProgressEvents.push(r))})}track(e){let{macros:t={},once:i=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"!=typeof t)return void this.emit("TRACKER-error",{message:"track given macros has the wrong type. macros: ".concat(t)});"closeLinear"===e&&!this.trackingEvents[e]&&this.trackingEvents.close&&(e="close"),e.startsWith("progress-")&&!e.endsWith("%")&&this.trackProgressEvents(e,t,i);const r=this.trackingEvents[e],n=this.emitAlwaysEvents.indexOf(e)>-1;r?(this.emit(e,{trackingURLTemplates:r}),this.trackURLs(r,t)):n&&this.emit(e,null),i&&(delete this.trackingEvents[e],n&&this.emitAlwaysEvents.splice(this.emitAlwaysEvents.indexOf(e),1))}trackURLs(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{validUrls:n,invalidUrls:s}=Pe.filterUrlTemplates(e);s.length&&this.emit("TRACKER-error",{message:"Provided urls are malformed. url: ".concat(s)});const o={...i};this.linear&&(this.creative&&this.creative.mediaFiles&&this.creative.mediaFiles[0]&&this.creative.mediaFiles[0].fileURL&&(o.ASSETURI=this.creative.mediaFiles[0].fileURL),this.progress&&(o.ADPLAYHEAD=this.progressFormatted())),null!==(t=this.creative)&&void 0!==t&&null!==(t=t.universalAdIds)&&void 0!==t&&t.length&&(o.UNIVERSALADID=this.creative.universalAdIds.map(e=>e.idRegistry.concat(" ",e.value)).join(",")),this.ad&&(this.ad.sequence&&(o.PODSEQUENCE=this.ad.sequence),this.ad.adType&&(o.ADTYPE=this.ad.adType),this.ad.adServingId&&(o.ADSERVINGID=this.ad.adServingId),this.ad.categories&&this.ad.categories.length&&(o.ADCATEGORIES=this.ad.categories.map(e=>e.value).join(",")),this.ad.blockedAdCategories&&this.ad.blockedAdCategories.length&&(o.BLOCKEDADCATEGORIES=this.ad.blockedAdCategories.map(e=>e.value).join(","))),Pe.track(n,o,r)}convertToTimecode(e){if(!Pe.isValidTimeValue(e))return"";const t=1e3*e,i=Math.floor(t/36e5),r=Math.floor(t/6e4%60),n=Math.floor(t/1e3%60),s=Math.floor(t%1e3);return"".concat(Pe.addLeadingZeros(i,2),":").concat(Pe.addLeadingZeros(r,2),":").concat(Pe.addLeadingZeros(n,2),".").concat(Pe.addLeadingZeros(s,3))}progressFormatted(){return this.convertToTimecode(this.progress)}}const ut='<svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewBox="0 0 24 24" fill="none">\n<path d="M3.15838 13.9306C2.44537 12.7423 2.44537 11.2577 3.15838 10.0694V10.0694C3.37596 9.70674 3.73641 9.45272 4.1511 9.36978L5.84413 9.03117C5.94499 9.011 6.03591 8.95691 6.10176 8.87788L8.17085 6.39498C9.3534 4.97592 9.94468 4.26638 10.4723 4.45742C11 4.64846 11 5.57207 11 7.41928L11 16.5807C11 18.4279 11 19.3515 10.4723 19.5426C9.94468 19.7336 9.3534 19.0241 8.17085 17.605L6.10176 15.1221C6.03591 15.0431 5.94499 14.989 5.84413 14.9688L4.1511 14.6302C3.73641 14.5473 3.37596 14.2933 3.15838 13.9306V13.9306Z" stroke="white" stroke-width="2"/>\n<path d="M15 15L21 9" stroke="white" stroke-width="2" stroke-linecap="round"/>\n<path d="M21 15L15 9" stroke="white" stroke-width="2" stroke-linecap="round"/>\n</svg>',gt=e=>{const t=e?"gray":"white";return`<svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewBox="0 0 24 24" fill="none">\n<path d="M18 6L6 18" stroke="${t}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M6 6L18 18" stroke="${t}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>`},pt=1e3;const mt=e=>"boolean"==typeof e,ft=e=>Number.isInteger(e),bt=e=>"[object String]"===Object.prototype.toString.call(e),vt=e=>["top","bottom","top-left","top-right","bottom-left","bottom-right"].includes(e);const yt=()=>Math.round((new Date).getTime()/1e3),wt=e=>{const i=new t("user_engagement"),r="utsid-send";let n,c=0,h=!1,g=!1,m={clientHints:{},isScrollable:0,totalClicks:0,sessionLength:0,ippMissclicks:0,visible:0,caught:0,lastevent:0,isFullscreen:0,isTabFocused:0,eventImps:0,retryCounts:0,isScrolled:0,isMouseMoved:0,pagePercentageSeen:0,belowTheFoldSeen:0,touchEnd:0,touchMove:0,clicksByType:{idle:0,input:0,video:0,button:0,link:0,img:0},browsingTopics:[],ufp:P()},f=d(),b=yt();function v(){var t,r;0===m.isFullscreen&&(m.isFullscreen=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement?1:0),m.isTabFocused=document.hidden||document.mozHidden||document.webkitHidden?0:1,m.sessionStartTime=b,m.sessionId=f,m.sessionLength=yt()-b,m.timeZoneOffset=(new Date).getTimezoneOffset(),m.zones=[],e&&(m.zones=e.getZoneIds()),m.pUrl=encodeURIComponent(o()),m.pReferrer=encodeURIComponent((()=>{const e=document.referrer;return e?l(e):""})()),m.pTitle=encodeURI(u()),m.pDescription=encodeURIComponent(p("description",i)),m.pKeywords=encodeURIComponent(p("keywords",i)),m.pHasIframes=(()=>{const e=document.getElementsByTagName("iframe");return e.length?e.length:0})(),m.pWidth=Math.ceil(window.scrollWidth||document.body.scrollWidth),m.pHeight=Math.ceil(window.scrollHeight||document.body.scrollHeight),m.vWidth=Math.ceil(window.innerWidth||document.body.clientWidth),m.vHeight=Math.ceil(window.innerHeight||document.body.clientHeight),m.inIframe=a(),sessionStorage.getItem("template")&&(m.ippTemplate=sessionStorage.getItem("template")),m.visible=(t=m.vWidth,r=m.vHeight,a()&&(t<10||r<10)?0:1),m.caught=(()=>{let e=0;if(a())try{window.top.location.href}catch(t){e=1}return e})(),m.isScrollable=((e,t)=>{if(e>t){const i=.05;return e-t>Math.ceil(t*i)?1:0}return 0})(m.pHeight,m.vHeight)}function y(){i.debug("Touch move detected."),m.touchMove++,g=!0}function w(){1!==m.isMouseMoved&&(i.debug("Mouse move tracked"),m.isMouseMoved=1,g=!0)}function T(){i.debug("Touch end detected."),m.touchEnd++,g=!0,A()}function A(){if(i.debug("checkScrolling()"),m.pHeight<=m.vHeight)return m.pagePercentageSeen=100,void(m.belowTheFoldSeen=100);var e=Math.ceil(window.scrollTop||document.body.scrollTop),t=Math.ceil((e+m.vHeight)/m.pHeight*100);t>100&&(t=100),t!=m.pagePercentageSeen&&(i.debug("Scroll event detected."),m.isScrolled=1,g=!0),t>m.pagePercentageSeen&&(i.debug("Page percentage seen updated."),m.pagePercentageSeen=t,g=!0);var r=Math.ceil(e/(m.pHeight-m.vHeight)*100);r>100&&(r=100),r>m.belowTheFoldSeen&&(i.debug("Bellow the fold percentage seen updated."),m.belowTheFoldSeen=r,g=!0)}function k(){m.ippMissclicks++,g=!0}function E(e){i.debug("Click tracked"),m.totalClicks++;var t=e.target,r=null;do{null!==r&&""!==r||(r=C(t)),t=t.parentElement}while(t&&"body"!==t.nodeName.toLowerCase()&&"document"!==t.nodeName.toLowerCase());null===r&&(r="idle"),m.clicksByType[r]++,g=!0}function C(e){var t=null;return-1!==["a","video","button","input","textarea","img","select"].indexOf(e.nodeName.toLowerCase())&&("a"===(t=e.nodeName.toLowerCase())?t="link":"textarea"!==t&&"select"!==t||(t="input")),t}function S(){i.debug("Impression tracked"),m.eventImps++}function I(){i.debug("Retry tracked!"),m.retryCounts++}function x(){var e="//usrpubtrk.com/ut/hb.php?cb="+Math.random();return e+="&v=1",i.debug("Target Url: "+e.toString()),e}function R(e=!1){if(!h){if(h=!0,v(),e&&(m.lastevent=1),i.isDebugEnabled&&i.debug("send payload:",JSON.parse(JSON.stringify(m))),"navigator"in window&&"sendBeacon"in window.navigator&&void 0!==navigator.sendBeacon&&void 0!==Blob){m.sentTimestamp=Date.now();var t=new Blob([JSON.stringify(m)],{type:"text/plain; charset=UTF-8"});navigator.sendBeacon(x(),t)}else{var r="XMLHttpRequest"in window?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");r.open("POST",x(),!0),r.setRequestHeader("Content-Type","text/plain;charset=UTF-8");try{m.sentTimestamp=Date.now(),r.send(JSON.stringify(m))}catch(e){}}m.lastevent=0,h=!1}}function N(){i.debug("visibility state is",document.visibilityState),"hidden"===document.visibilityState&&g?(clearInterval(n),R(),g=!1):"visible"===document.visibilityState&&(n=setInterval(O,6e4))}function L(){var e=new CustomEvent(r,{detail:{issued:"UT",data:{utsid:f}}});document.dispatchEvent(e)}function O(){if(m.sessionLength=yt()-b,m.sessionLength>=7200)return i.debug("Session limit reached! Send last payload and tear down"),R(),clearInterval(n),i.debug("detaching behavior listeners"),document.removeEventListener("click",E,!1),document.removeEventListener("mousemove",w,!1),document.removeEventListener("scroll",A,!1),document.removeEventListener("in-page-missclick",k,!1),document.removeEventListener("impression-event",S,!1),document.removeEventListener("impression-retry-event",I,!1),document.removeEventListener("touchend",T,!1),document.removeEventListener("touchmove",y,!1),document.removeEventListener("touchcancel",A,!1),document.removeEventListener("visibilitychange",N),void window.removeEventListener("beforeunload",R);0!==c&&1!==c&&5!==c&&10!==c&&c%30!=0||R(),c++}!async function e(){if("complete"===document.readyState||"interactive"===document.readyState)return m.clientHints=await s(i,true),m.browsingTopics=await async function(){let e=[];if("browsingTopics"in document&&document.featurePolicy.allowsFeature("browsing-topics"))try{e=await document.browsingTopics(),i.debug("document.browsingTopics() return value:",e)}catch(e){i.debug("Error calling document.browsingTopics(): ",e)}return e}()