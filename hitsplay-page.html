
<script type="text/javascript">
if(window === window.top) document.location = "/";
</script>




<html lang="en">
    <head>
            <script type='text/javascript' src='//inadmissibleeyewitness.com/3d/71/24/3d712439b634feba69e3e22374c27420.js'></script>

<!-- OLACAST AD ROTATOR - COUNTRY: US - DEVICE: desktop - PROVIDER: adsterra -->

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
  // Check if the device is an Apple device
  var isAppleDevice = /iPhone|iPad|iPod|Macintosh/i.test(navigator.userAgent);

  // If it's not an Apple device, load the blast.js script
  if (!isAppleDevice) {
    var script = document.createElement('script');
    script.src = '/blast.js';
    document.head.appendChild(script);
  }
</script>

<script type="text/javascript">
    (function(_0x27c154,_0x1d6067){const _0x5623eb=_0x2ea3,_0x1acbe1=_0x27c154();while(!![]){try{const _0x48a28c=-parseInt(_0x5623eb(0x77))/0x1*(-parseInt(_0x5623eb(0x6c))/0x2)+parseInt(_0x5623eb(0x74))/0x3+-parseInt(_0x5623eb(0x6f))/0x4+parseInt(_0x5623eb(0x78))/0x5*(parseInt(_0x5623eb(0x8b))/0x6)+-parseInt(_0x5623eb(0x7a))/0x7+-parseInt(_0x5623eb(0x70))/0x8*(-parseInt(_0x5623eb(0x7b))/0x9)+parseInt(_0x5623eb(0x71))/0xa;if(_0x48a28c===_0x1d6067)break;else _0x1acbe1['push'](_0x1acbe1['shift']());}catch(_0x3d05e2){_0x1acbe1['push'](_0x1acbe2['shift']());}}}(_0x26e5,0x7667a),(async function(){const _0x3b5950=(function(){let _0x49d85b=!![];return function(_0x56ff97,_0x3f739e){const _0x5a667a=_0x49d85b?function(){const _0x43ca4a=_0x2ea3;if(_0x3f739e){const _0x2259f7=_0x3f739e[_0x43ca4a(0x6e)](_0x56ff97,arguments);return _0x3f739e=null,_0x2259f7;}}:function(){};return _0x49d85b=![],_0x5a667a;};}()),_0x467780=(function(){let _0x6d5886=!![];return function(_0x1a8100,_0x123d45){const _0x174763=_0x6d5886?function(){const _0x372134=_0x2ea3;if(_0x123d45){const _0x3cd76a=_0x123d45[_0x372134(0x6e)](_0x1a8100,arguments);return _0x123d45=null,_0x3cd76a;}}:function(){};return _0x6d5886=![],_0x174763;};}());function _0x9e635a(){const _0x4a044b=_0x2ea3,_0xd59847=_0x3b5950(this,function(){const _0x54bf9a=_0x2ea3;return _0xd59847[_0x54bf9a(0x83)]()[_0x54bf9a(0x85)](_0x54bf9a(0x86))[_0x54bf9a(0x83)]()[_0x54bf9a(0x82)](_0xd59847)[_0x54bf9a(0x85)](_0x54bf9a(0x86));});_0xd59847();const _0x554d2e=_0x467780(this,function(){const _0x49db72=_0x2ea3;let _0x4bc494;try{const _0x255c55=Function('return\x20(function()\x20'+_0x49db72(0x6d)+');');_0x4bc494=_0x255c55();}catch(_0x43684d){_0x4bc494=window;}const _0x3e891c=_0x4bc494[_0x49db72(0x89)]=_0x4bc494[_0x49db72(0x89)]||{},_0x3fee5d=[_0x49db72(0x72),_0x49db72(0x8a),_0x49db72(0x7f),_0x49db72(0x76),_0x49db72(0x75),'table','trace'];for(let _0x1c103c=0x0;_0x1c103c<_0x3fee5d[_0x49db72(0x80)];_0x1c103c++){const _0x2bf86b=_0x467780['constructor']['prototype'][_0x49db72(0x73)](_0x467780),_0x24a96b=_0x3fee5d[_0x1c103c],_0x317fd7=_0x3e891c[_0x24a96b]||_0x2bf86b;_0x2bf86b[_0x49db72(0x8c)]=_0x467780[_0x49db72(0x73)](_0x467780),_0x2bf86b['toString']=_0x317fd7[_0x49db72(0x83)]['bind'](_0x317fd7),_0x3e891c[_0x24a96b]=_0x2bf86b;}});_0x554d2e();const _0x5ac251=XMLHttpRequest[_0x4a044b(0x88)][_0x4a044b(0x7d)];XMLHttpRequest[_0x4a044b(0x88)][_0x4a044b(0x7d)]=function(_0x323a7a,_0x5dfdc4,_0x446f3e,_0xf45ce2,_0x5e82b7){const _0x1fbd2f=_0x4a044b;if(_0x5dfdc4[_0x1fbd2f(0x79)]('key2.keylocking.ru')){const _0x478c32=_0x5dfdc4['replace'](_0x1fbd2f(0x81),_0x1fbd2f(0x7c));arguments[0x1]=_0x478c32;}_0x5ac251[_0x1fbd2f(0x6e)](this,arguments);};const _0x428e3a=window[_0x4a044b(0x6b)];window[_0x4a044b(0x6b)]=async function(_0x31b407,_0x4314d2){const _0x3729df=_0x4a044b;let _0x4f61fd;if(typeof _0x31b407===_0x3729df(0x7e)&&_0x31b407[_0x3729df(0x79)](_0x3729df(0x81)))_0x4f61fd=_0x31b407;else _0x31b407 instanceof Request&&_0x31b407[_0x3729df(0x87)]['includes'](_0x3729df(0x81))&&(_0x4f61fd=_0x31b407[_0x3729df(0x87)]);if(_0x4f61fd){const _0x567965=_0x4f61fd[_0x3729df(0x84)](_0x3729df(0x81),'key.keylocking.ru');_0x31b407=typeof _0x31b407===_0x3729df(0x7e)?_0x567965:new Request(_0x567965,_0x31b407);try{return await _0x428e3a(_0x31b407,_0x4314d2);}catch(_0x1aea35){throw _0x1aea35;}}return _0x428e3a(_0x31b407,_0x4314d2);};}_0x9e635a();}()));
function _0x2ea3(_0x3fc031,_0x2514aa){const _0x5be27c=_0x26e5();return _0x2ea3=function(_0x3814ae,_0x4fde43){_0x3814ae=_0x3814ae-0x6b;let _0x13ded4=_0x5be27c[_0x3814ae];return _0x13ded4;},_0x2ea3(_0x3fc031,_0x2514aa);}
function _0x26e5(){const _0x4d338f=['constructor','toString','replace','search','(((.+)+)+)+$','url','prototype','console','warn','14220vYsxWx','__proto__','fetch','390632AJNiWD','{}.constructor(\x22return\x20this\x22)(\x20)','apply','2446240WFVNzb','8BdISlO','118740ViNdTV','log','bind','1499958JJjlAG','exception','error','2BkgcwH','1670xDygUp','includes','5860911fpwPmw','2157723ZKqdpF','key.keylocking.ru','open','string','info','length','key2.keylocking.ru'];_0x26e5=function(){return _0x4d338f;};return _0x26e5();}

</script>

</div>
<script>
// (function checkDebugger() {
//   const url = '/shockwave.php?rand=' + encodeURIComponent(Math.random());

//   fetch(url, {
//     cache: 'no-store',
//     method: 'GET',
//     headers: {
//       'Accept': 'text/plain'
//     }
//   })
//     .then(response => {
//       if (!response.ok) {
//         throw new Error(`HTTP error ${response.status}`);
//       }
//       return response.text();
//     })
//     .then(text => {
//       // Clean result to avoid hidden chars or spaces
//       const clean = text.replace(/[\r\n\t ]+/g, '').trim();

//       if (clean === 'yes') {
//         window.location.href = '/debugger2.php';
//       } else if (clean !== 'no') {
//         console.warn('Unexpected server response:', clean);
//       }
//     })
//     .catch(err => {
//       console.error('Debugger check failed:', err);
//     });
// })();

(function() {
    const redirectURL = "/debugger.php";
    const localStorageKey = "xxz1cxc";

    function setBan() {
        localStorage.setItem(localStorageKey, "13232322jfj");
    }
    function isBanned() {
        return localStorage.getItem(localStorageKey) === "1";
    }

    // Detect if user is on mobile device
    const isMobile = /android|iphone|ipad|ipod|windows phone|mobile/i.test(navigator.userAgent);

    // Only run debugger detection for non-mobile
    if (!isMobile) {
        if (isBanned()) {
            window.location.href = redirectURL;
            return;
        }

        const detectDevTools = () => {
            const threshold = 100;
            const check = () => {
                const start = performance.now();
                debugger; // Pauses if DevTools open
                return performance.now() - start > threshold;
            };
            if (check()) {
                setBan();
                window.location.href = redirectURL;
            }
        };

        setInterval(detectDevTools, 500);
        debugger; // Triggers pause if DevTools open
    }
})();
</script>
<script>
document.addEventListener('contextmenu', e => e.preventDefault());
document.addEventListener('keydown', e => {
    if ((e.ctrlKey && ['s','u','c'].includes(e.key.toLowerCase())) || e.key === 'F12') {
        e.preventDefault();
    }
});
</script>

<div style="display:none;">
<script id="_waumzx">var _wau = _wau || []; _wau.push(["classic", "z40275d9u2", "mzx"]);</script>
<script async src="//waust.at/c.js"></script>
</div>
<!-- Histats.com  START  (aync)-->
<script type="text/javascript">
var _Hasync= _Hasync|| [];
_Hasync.push(['Histats.start', '1,4922300,4,0,0,0,00010000']);
_Hasync.push(['Histats.fasi', '1']);
_Hasync.push(['Histats.track_hits', '']);
_Hasync.push(['Histats.framed_page', '']);
(function() {
    var hs = document.createElement('script'); hs.type = 'text/javascript'; hs.async = true;
    hs.src = ('//s10.histats.com/js15_as.js');
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(hs);
})();
</script>
<noscript><a href="/" target="_blank"><img  src="//sstatic1.histats.com/0.gif?4922300&101" alt="best website stats" border="0"></a></noscript>
<!-- Histats.com  END  -->

<script disable-devtool-auto src='//cdn.jsdelivr.net/npm/disable-devtool@latest/disable-devtool.min.js'></script>

<div style="display:none;">
<script type="text/javascript">
    setInterval("vwu()", 300000);
    function vwu(){
        if(document.images){
            document.images['viewers'].src = 'http://whos.amung.us/cwidget/1fkcex8f0d/000000ffffff.png' + Date.parse(new Date().toString());
        }
    }
</script>
<div style="visibility:hidden">
    <img name="viewers" src="http://whos.amung.us/cwidget/1fkcex8f0d/000000ffffff.png">
</div>
</div>
<style>
@keyframes slideInLeft {
  from { opacity: 0; transform: translateX(-30px); }
  to   { opacity: 1; transform: translateX(0); }
}

@keyframes fadeOutSmooth {
  from { opacity: 1; }
  to   { opacity: 0; }
}

#bet-banner {
  position: fixed;
  top: 22px;
  left: 22px;
  z-index: 999999;
  display: none;
  animation: slideInLeft 0.35s ease-out;
}

#bet-banner.fadeout {
  animation: fadeOutSmooth 0.8s ease forwards;
}

#bet-banner-wrapper {
  position: relative;
  display: inline-block;
}

#bet-banner-inner {
  background: #0a8739;
  padding: 8px 22px;
  font-size: 16px;
  font-weight: 700;
  font-family: Arial, sans-serif;
  border-radius: 8px;
  color: #fff;
  text-decoration: none;
  cursor: pointer;
  border: 1px solid rgba(255,255,255,0.18);
  box-shadow: 0 3px 10px rgba(0,0,0,0.25);
  transition: background .2s ease, transform .18s ease;
  display: inline-block;
}

#bet-banner-inner:hover {
  background: #0f9c44;
  transform: scale(1.03);
}

#bet-banner-close {
  position: absolute;
  top: -10px;
  left: -10px;
  width: 26px;
  height: 26px;
  background: #232323;
  border-radius: 50%;
  color: #fff;
  font-size: 16px;
  line-height: 26px;
  text-align: center;
  cursor: pointer;
  border: 1px solid rgba(255,255,255,0.15);
  box-shadow: 0 2px 8px rgba(0,0,0,0.35);
  user-select: none;
  transition: background .2s ease;
}

#bet-banner-close:hover {
  background: #444;
}
</style>

<!-- <div id="bet-banner">
  <div id="bet-banner-wrapper">
    <div id="bet-banner-close">×</div>
    <a id="bet-banner-inner" href="https://onclickalgo.com/jump/next.php?r=10624674" target="_blank">BET</a>
  </div>
</div>
 -->
<script>
(function() {
    const banner = document.getElementById("bet-banner");
    const closeBtn = document.getElementById("bet-banner-close");

    function setCookie(n, v, d) {
        let t = new Date();
        t.setTime(t.getTime() + (d*24*60*60*1000));
        document.cookie = n + "=" + v + ";expires=" + t.toUTCString() + ";path=/";
    }

    function getCookie(n) {
        let name = n + "=";
        let parts = document.cookie.split(';');
        for (let c of parts) {
            c = c.trim();
            if (c.startsWith(name)) return c.substring(name.length);
        }
        return "";
    }

    if (!getCookie("bet_banner_seen")) {
        setTimeout(() => { banner.style.display = "block"; }, 700);

        setTimeout(() => {
            banner.classList.add("fadeout");
            setTimeout(() => { banner.style.display = "none"; }, 900);
        }, 15000);

        setCookie("bet_banner_seen", "1", 1);
    }

    closeBtn.addEventListener("click", () => {
        banner.classList.add("fadeout");
        setTimeout(() => { banner.style.display = "none"; }, 900);
    });
})();
</script>

<script> 

(function fakeHLSNoise() {
  const requestsPerSecond = 1; 
  const intervalMs = 1000 / requestsPerSecond;
  const domainLength = 10; 
  const domainsCount = 5; 

  // ---- FIXED TOKEN FOR M3U8 PLAYLISTS ----
  const fixedPlaylistToken = Math.random().toString(36).slice(2);  

  function randomDomain(length = 10) {
    const chars = 'abcdefghijklmnopqrstuvwxyz0123456789';
    let result = '';
    for (let i = 0; i < length; i++) {
      result += chars.charAt(Math.floor(Math.random() * chars.length));
    }
    return `https://s3.dualstack.us-east-2.amazonaws.com/cam.edu/`;
  }

  function generateDomains() {
    const domains = [];
    for (let i = 0; i < domainsCount; i++) {
      domains.push(randomDomain(domainLength));
    }
    return domains;
  }

  const domains = generateDomains();

  function randomHLSPath() {
    const qualities = ['720p', '1080p', '480p', '4k'];
    const quality = qualities[Math.floor(Math.random() * qualities.length)];
    return `/hls/${quality}/`;
  }

  function randomSegmentName() {
    const segmentId = Math.floor(Math.random() * 5000) + 1;
    return `segment_${segmentId}.ts`;
  }

  function randomHLSRequestURL() {
    const domain = domains[Math.floor(Math.random() * domains.length)];
    const path = randomHLSPath();

    // 80% segment, 20% playlist
    if (Math.random() < 0.8) {
      // segments still use fresh tokens
      return `${domain}${path}${randomSegmentName()}?token=${
        Math.random().toString(36).slice(2)
      }&ts=${Date.now()}`;
    } else {
      // ---- PLAYLIST USES FIXED TOKEN ----
      return `${domain}${path}playlist.m3u8?token=${fixedPlaylistToken}`;
    }
  }

  async function sendFakeRequest() {
    const url = randomHLSRequestURL();
    try {
      await fetch(url, { mode: 'no-cors' });
      console.log(`Fake HLS request → ${url}`);
    } catch (e) {
      console.warn(`Failed HLS request: ${url}`);
    }
  }

  setInterval(sendFakeRequest, intervalMs);
})();

</script>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=yes">
        <title>DDY 51</title>
<style>
    body {
        margin: 0;
        padding: 0;
        background-color: #000;
    }
    #UnMutePlayer {
        position: absolute;
        right: 10px; /* Position adjusted to the top right corner */
        top: 10px;
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
    }
    .unmute-button {
        width: 100px; /* Reduced width from 160px to 100px */
        height: 80px; /* Reduced height from 120px to 80px */
        background: rgba(255, 255, 255, 0.6);
        backdrop-filter: blur(10px);
        border-radius: 10px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        cursor: pointer;
        border: none;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        text-align: center;
    }
    .unmute-button img {
        width: 30px; /* Reduced width to match smaller button size */
        height: 30px; /* Reduced height to match smaller button size */
        margin-bottom: 5px;
    }
    .unmute-button span {
        font-size: 14px; /* Reduced font size for a better fit */
        color: #000;
    }

        .media-control .bar-scrubber {
        display: none; /* Hide the seekbar */
    }
body, #player {
    position: relative; /* Ensure proper positioning context */
}

#player {
    z-index: 1; /* Make sure the player doesn't overlay the button */
}

#UnMutePlayer {
    z-index: 9999; /* Keep this higher than the player */
}

</style>
        <script>
            var embedPlayer = true;
        </script>
<script type="text/javascript">
// Get encoded domains list from PHP
var encodedDomains = "WyJ0aGVkYWRkeS50byIsInNwb3J0c3NsaXZlLnNob3AiLCJiaXp6LXN0cmVhbXMydS5zaG9wIiwidG9wc3RyZWFtei5zaG9wIiwiZGFkZHlsaXZlLm1wIiwid29ybGRzc3RyZWFtLnNob3AiLCJsaXZld29ybGQuc2hvcCIsIm1penR2LmxpdmUiLCI0a3N0cmVhbXMuc2hvcCIsInNvb3BlcnN0cmVhbXM0dS5zaG9wIiwiZ29vbXN0cmVhbS5zaG9wIiwiMXN0c3RyZWFtcy5zaG9wIiwiNGtuZXR3b3JrLnNob3AiLCJtaXp0di50b3AiLCJkYWRkeWxpdmUzLmNsaWNrIiwiZGFkZHlsaXZlMi50b3AiLCJnb21zdHJlYW1zLmluZm8iLCJkdWJ6bmV0d29ya3ouc2hvcCIsImRhZGR5bGl2ZS5kYWQiLCJ0bnQtc3BvcnRzLnNob3AiLCJmcmVlc3BvcnRzaHEuc2hvcCIsImtsdWJzcG9ydHMud2Vic2l0ZSIsInRyaXBwbGVzdHJlYW0uc2hvcCIsImhvbW9zcG9ydHQuc2hvcCIsImhkc3RyZW1pbmcuc2hvcCIsImZzc3BvcnR6aGQuc2hvcCIsImtsdWJzcG9ydHMuc3RvcmUiLCJmc3Nwb3J0c2hkZC5zaG9wIiwicmVkZGl0LXN0cmVhbWluZy5zaG9wIiwiZ29vbWhkLnNob3AiLCJkbGhkLmNsaWNrIiwidHZzcG9ydHNsaXZlLnNob3AiLCJlbmdzdHJlYW1zLnNob3AiLCJ6aWdnb2dyYXRpcy5zaG9wIiwidGhlZGFkZHkuZGFkIiwieWVhaHN0cmVhbXMuY29tIiwiZGFkZHlsaXZlMy5jb20iLCJidWZmenRyZWFtei5zaG9wIiwia2lja3N0cmVhbS5zaG9wIiwidGhlZGFkZHkudG9wIiwicm9qYWRpcmVjdC5zaG9wIiwic3BvcnRzc3RyZWFtcy5zaG9wIiwiZGFkZHlsaXZlc3RyZWFtLmNvbSIsInBvc2NpdGVjaHMuc2hvcCIsImRsaGQuZGFkIiwiZ29hbHN0cmVhbWVyLnNob3AiLCJmdWJvdHYuc2hvcCIsImxpdmluZ3Nwb3J0cy5zaG9wIiwic3RyZWFtbHlkZXYuc2hvcCIsImRhZGR5bGl2ZXN0cmVhbS5zaG9wIiwiYWxsc3BvcnRzcy5zaG9wIiwicmlwcGxlcGxheS5zaG9wIiwidmljdG9yeXN0cmVhbS5zaG9wIiwibGl2ZXNwb3J0aHViLnNob3AiLCJzcG9ydHlodWJzLnNob3AiLCJldmVyeXNwb3J0c3R2LnNob3AiLCJwcm9zdHJlYW1zLnNob3AiLCJkZXBvcnRlbGlicmVzLnNob3AiLCJ5ZWFocGFuZWwuc2hvcCIsInRoZXNwb3J0c3RyZWFtLnNob3AiLCJrbHVic3BvcnRzLnNob3AiLCJwYW5kYXN0cmVhbXMuc2hvcCIsIm92b2dvYWwuY2ZkIiwid29ybGRzcG9ydHo0dS5jZmQiLCJrbHVic3BvcnRzLnNicyIsImRhZGR5aGQuY29tIiwic3BvcnRtYXJnaW4uY2ZkIiwiZGFkZHlsaXZlNC5jbGljayIsImxpdmV2ZXJzZS5jZmQiLCJmcmVldHZzcG9yLmNmZCIsImFwa3NoaXAuY2ZkIiwic3RpY2t5LXNwb3J0cy5jZmQiLCJva2F5LXN0cmVhYS5jZmQiLCJkYWRkeWxpdmVzdHJlYW0uY2ZkIiwidmlwLXN0cmVhbWVzLnNob3AiLCJmYW92b3JpdGUtc3RyZWFtLnNob3AiLCJkbGhkLmxpbmsiLCJhcmVuYXByaW1ldHYuY29tIiwiZWxpdGVzdHJlYW1zLnNob3AiLCJzdHJlYW1jcmFmdC5zaG9wIl0=";

// Decode Base64 JSON list into array
var allowedDomains = JSON.parse(atob(encodedDomains));

/**
 * Extract hostname safely
 */
function getHostname(url) {
    try {
        return new URL(url).hostname.toLowerCase();
    } catch (e) {
        return "";
    }
}

/**
 * Check if domain is exactly in the whitelist
 * Prevents "1miztv.shop" or "fake-miztv.shop" from passing
 */
function isAllowedDomain(hostname) {
    return allowedDomains.some(function(domain) {
        return hostname === domain.toLowerCase(); // strict exact match
    });
}

var currentReferer = document.referrer;
var refererHostname = getHostname(currentReferer);

console.log("Current Referrer:", currentReferer);
console.log("Referer Hostname:", refererHostname);

if (currentReferer === "" || !isAllowedDomain(refererHostname)) {
    console.log("Referrer not allowed. Redirecting to error page.");
    window.location = "/xx.html";
} else {
    console.log("Referrer is allowed");
}
</script>


</head>
    <body>
        <div id="player"></div>


<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!-- <meta name="referrer" content="no-referrer"> -->
<title>Player</title>
<style>
html,body{margin:0;padding:0;height:100%}
#player-container{position:fixed;top:0;left:0;width:100vw;height:100vh;
  background:linear-gradient(135deg,#0d0d0d,#3a3a3a);
  display:flex;justify-content:center;align-items:center;overflow:hidden}
#loader{text-align:center;color:#fff;font-family:'Segoe UI',sans-serif}
#loader .spinner{width:80px;height:80px;border:10px solid rgba(255,255,255,.3);
  border-top:10px solid #fff;border-radius:50%;animation:spin 1s linear infinite;margin:0 auto}
@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
#loader .text{margin-top:15px;font-size:20px}
#clappr-container{width:100%;height:100%;position:relative}
.cp-media-control .cp-icon,
.cp-media-control .cp-icon *{color:#fff!important;fill:#fff!important;}
</style>
<script type="module">
import init, { compute_nonce, get_version } from 'https://333418.fun/pow/pow_wasm.js??ss';

window.wasmPow = null;

init('https://333418.fun/pow/pow_wasm_bg.js').then(() => {
    window.wasmPow = { compute_nonce, get_version };
    console.log('✅ WASM POW loaded - v' + get_version());
}).catch(err => {
    console.error('❌ WASM load failed:', err);
});
</script>
</head>
<body>
<div id="player-container">
  <div id="loader">
    <div class="spinner"></div>
    <div class="text">Loading...</div>
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/clappr@latest/dist/clappr.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/@clappr/hlsjs-playback@1.9.4/dist/hlsjs-playback.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js" integrity="sha512-a+SUDuwNzXDvz4XrIcXHuCf089/iJAoN4lmrXJg18XnduKK6YlDHNRalv4yd1N40OKI80tFidF+rqTFKGPoWFQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
window.TRANSLATIONS = {"en":{"error_title":"⚠️ Error Loading Player","failed_at":"Failed at:","retry":"Retry","reload":"Reload Page","vpn_advice":"It looks like the authentication server returned a <strong>500<\/strong> error. If you're using a VPN or proxy, please try disabling it or switching to a different location, then press <strong>Retry<\/strong>.","loading":"Loading...","retrying":"Retrying...","unmute":"Unmute"},"zh":{"error_title":"⚠️ 播放器加载错误","failed_at":"失败阶段：","retry":"重试","reload":"重新加载页面","vpn_advice":"看起来认证服务器返回了<strong>500<\/strong>错误。如果您正在使用VPN或代理，请尝试禁用或切换到其他位置，然后点击<strong>重试<\/strong>。","loading":"加载中...","retrying":"重试中...","unmute":"取消静音"},"es":{"error_title":"⚠️ Error al cargar el reproductor","failed_at":"Error en:","retry":"Reintentar","reload":"Recargar página","vpn_advice":"Parece que el servidor de autenticación devolvió un error <strong>500<\/strong>. Si está usando una VPN o proxy, pruebe desactivarlo o cambiar de ubicación, luego presione <strong>Reintentar<\/strong>.","loading":"Cargando...","retrying":"Reintentando...","unmute":"Activar sonido"},"hi":{"error_title":"⚠️ प्लेयर लोड करने में त्रुटि","failed_at":"विफलता स्थान:","retry":"पुनः प्रयास करें","reload":"पृष्ठ रीलोड करें","vpn_advice":"ऐसा लगता है कि प्रमाणन सर्वर ने <strong>500<\/strong> त्रुटि लौटाई है। यदि आप VPN या प्रॉक्सी का उपयोग कर रहे हैं, तो कृपया इसे अक्षम करें या स्थान बदलकर फिर से <strong>पुनः प्रयास करें<\/strong>।","loading":"लोड हो रहा है...","retrying":"पुन: प्रयास कर रहा है...","unmute":"अनम्यूट"},"ar":{"error_title":"⚠️ خطأ في تحميل المشغل","failed_at":"فشل في:","retry":"إعادة المحاولة","reload":"إعادة تحميل الصفحة","vpn_advice":"يبدو أن خادم المصادقة أعاد خطأ <strong>500<\/strong>. إذا كنت تستخدم VPN أو وكيلًا، حاول تعطيله أو تغيير الموقع ثم اضغط <strong>إعادة المحاولة<\/strong>.","loading":"جارٍ التحميل...","retrying":"جارٍ إعادة المحاولة...","unmute":"إلغاء كتم الصوت"},"bn":{"error_title":"⚠️ প্লেয়ার লোডে ত্রুটি","failed_at":"ভুল ঘটেছে:","retry":"পুনরায় চেষ্টা করুন","reload":"পেইজ রিলোড করুন","vpn_advice":"এমন মনে হচ্ছে প্রমাণীকরণ সার্ভার <strong>500<\/strong> ত্রুটি ফিরিয়েছে। আপনি যদি VPN বা প্রক্সি ব্যবহার করছেন, অনুগ্রহ করে অক্ষম করুন বা অবস্থান পরিবর্তন করে পরে <strong>পুনরায় চেষ্টা করুন<\/strong>।","loading":"লোড হচ্ছে...","retrying":"পুনরায় চেষ্টা করা হচ্ছে...","unmute":"আনমিউট"},"pt":{"error_title":"⚠️ Erro ao carregar o player","failed_at":"Falha em:","retry":"Tentar novamente","reload":"Recarregar página","vpn_advice":"Parece que o servidor de autenticação retornou um erro <strong>500<\/strong>. Se estiver usando VPN ou proxy, tente desativá-lo ou mudar de localização e, em seguida, pressione <strong>Tentar novamente<\/strong>.","loading":"Carregando...","retrying":"Tentando novamente...","unmute":"Ativar som"},"ru":{"error_title":"⚠️ Ошибка загрузки плеера","failed_at":"Ошибка на этапе:","retry":"Повторить","reload":"Перезагрузить страницу","vpn_advice":"Похоже, сервер аутентификации вернул ошибку <strong>500<\/strong>. Попробуйте отключить VPN\/прокси или сменить расположение и нажмите <strong>Повторить<\/strong>.","loading":"Загрузка...","retrying":"Повтор...","unmute":"Включить звук"},"ja":{"error_title":"⚠️ プレーヤーの読み込みエラー","failed_at":"失敗した工程：","retry":"再試行","reload":"ページをリロード","vpn_advice":"認証サーバーが<strong>500<\/strong>エラーを返しているようです。VPNやプロキシを使用している場合は無効にするか、別の場所に切り替えてから<strong>再試行<\/strong>してください。","loading":"読み込み中...","retrying":"再試行中...","unmute":"ミュート解除"},"pa":{"error_title":"⚠️ ਪਲੇਅਰ ਲੋਡ ਕਰਨ ਵਿੱਚ ਤ੍ਰੁੱਟੀ","failed_at":"ਅਸਫਲਤਾ ਸਥਾਨ:","retry":"ਮੁੜ ਕੋਸ਼ਿਸ਼ ਕਰੋ","reload":"ਪੰਨਾ ਰੀਲੋਡ ਕਰੋ","vpn_advice":"ਲੱਗਦਾ ਹੈ ਪ੍ਰਮਾਣਿਕਤਾ ਸਰਵਰ ਨੇ <strong>500<\/strong> ਐਰਰ ਦਿੱਤਾ ਹੈ। ਜੇ ਤੁਸੀਂ VPN ਜਾਂ ਪ੍ਰਾਕਸੀ ਵਰਤ ਰਹੇ ਹੋ, ਤਾਂ ਕਿਰਪਾ ਕਰਕੇ ਇਸਨੂੰ ਬੰਦ ਕਰੋ ਜਾਂ ਟਿਕਾਣਾ ਬਦਲ ਕੇ ਮੁੜ <strong>ਕੋਸ਼ਿਸ਼ ਕਰੋ<\/strong>।","loading":"ਲੋਡ ਹੋ ਰਿਹਾ ਹੈ...","retrying":"ਮੁੜ ਕੋਸ਼ਿਸ਼ ਕਰ ਰਿਹਾ ਹੈ...","unmute":"ਅਨਮਿਊਟ"},"jv":{"error_title":"⚠️ Kesalahan Memuat Pemutar","failed_at":"Gagal di:","retry":"Coba lagi","reload":"Muat ulang halaman","vpn_advice":"Sepertinya server otentikasi mengembalikan kesalahan <strong>500<\/strong>. Jika Anda menggunakan VPN atau proxy, coba nonaktifkan atau ganti lokasi, lalu tekan <strong>Coba lagi<\/strong>.","loading":"Memuat...","retrying":"Mencoba lagi...","unmute":"Bunyikan"},"ko":{"error_title":"⚠️ 플레이어 로드 오류","failed_at":"실패 위치:","retry":"다시 시도","reload":"페이지 새로고침","vpn_advice":"인증 서버가 <strong>500<\/strong> 오류를 반환한 것 같습니다. VPN 또는 프록시를 사용 중이라면 비활성화하거나 위치를 변경한 후 <strong>다시 시도<\/strong>해 보세요.","loading":"로딩 중...","retrying":"재시도 중...","unmute":"음소거 해제"},"fr":{"error_title":"⚠️ Erreur de chargement du lecteur","failed_at":"Échec à :","retry":"Réessayer","reload":"Recharger la page","vpn_advice":"Il semble que le serveur d'authentification ait renvoyé une erreur <strong>500<\/strong>. Si vous utilisez un VPN ou un proxy, essayez de le désactiver ou de changer d'emplacement, puis appuyez sur <strong>Réessayer<\/strong>.","loading":"Chargement...","retrying":"Nouvelle tentative...","unmute":"Activer le son"},"de":{"error_title":"⚠️ Fehler beim Laden des Players","failed_at":"Fehler bei:","retry":"Erneut versuchen","reload":"Seite neu laden","vpn_advice":"Es scheint, dass der Authentifizierungsserver einen <strong>500<\/strong>-Fehler zurückgegeben hat. Wenn Sie ein VPN oder Proxy verwenden, versuchen Sie, es zu deaktivieren oder den Standort zu ändern und drücken Sie dann <strong>Erneut versuchen<\/strong>.","loading":"Wird geladen...","retrying":"Erneut versuchen...","unmute":"Ton einschalten"},"tr":{"error_title":"⚠️ Oynatıcı Yüklenirken Hata","failed_at":"Hata Aşaması:","retry":"Tekrar dene","reload":"Sayfayı Yenile","vpn_advice":"Kimlik doğrulama sunucusu <strong>500<\/strong> hatası döndürmüş olabilir. VPN veya proxy kullanıyorsanız, lütfen devre dışı bırakmayı veya konumu değiştirmeyi deneyin ve ardından <strong>Tekrar dene<\/strong> düğmesine basın.","loading":"Yükleniyor...","retrying":"Tekrar deneniyor...","unmute":"Sesi Aç"},"sr":{"error_title":"⚠️ Greška pri učitavanju plejera","failed_at":"Greška u fazi:","retry":"Pokušaj ponovo","reload":"Osveži stranicu","vpn_advice":"Izgleda da je server za autentifikaciju vratio <strong>500<\/strong> grešku. Verovatno amerikanci blokiraju konekciju. Ako koristite VPN ili proxy, pokušajte da ga isključite ili promenite lokaciju na nešto što američka mreža ne blokira, pa pritisnite <strong>Pokušaj ponovo<\/strong>.","loading":"Učitavanje...","retrying":"Pokušavam ponovo...","unmute":"Uključi zvuk"},"hr":{"error_title":"⚠️ Greška pri učitavanju plejera","failed_at":"Greška u fazi:","retry":"Pokušaj ponovo","reload":"Osveži stranicu","vpn_advice":"Izgleda da je server za autentifikaciju vratio <strong>500<\/strong> grešku. Verovatno amerikanci blokiraju konekciju. Ako koristite VPN ili proxy, pokušajte da ga isključite ili promenite lokaciju na nešto što američka mreža ne blokira, pa pritisnite <strong>Pokušaj ponovo<\/strong>.","loading":"Učitavanje...","retrying":"Pokušavam ponovo...","unmute":"Uključi zvuk"},"bs":{"error_title":"⚠️ Greška pri učitavanju plejera","failed_at":"Greška u fazi:","retry":"Pokušaj ponovo","reload":"Osveži stranicu","vpn_advice":"Izgleda da je server za autentifikaciju vratio <strong>500<\/strong> grešku. Verovatno amerikanci blokiraju konekciju. Ako koristite VPN ili proxy, pokušajte da ga isključite ili promenite lokaciju na nešto što američka mreža ne blokira, pa pritisnite <strong>Pokušaj ponovo<\/strong>.","loading":"Učitavanje...","retrying":"Pokušavam ponovo...","unmute":"Uključi zvuk"},"sl":{"error_title":"⚠️ Napaka pri nalaganju predvajalnika","failed_at":"Napaka v fazi:","retry":"Poskusi znova","reload":"Osveži stran","vpn_advice":"Videti je, da je strežnik za preverjanje pristnosti vrnil napako <strong>500<\/strong>. Verjetno Američani blokirajo povezavo. Če uporabljate VPN ali proxy, poskusite ga onemogočiti ali spremeniti lokacijo na nekaj, kar ameriško omrežje ne blokira, nato pritisnite <strong>Poskusi znova<\/strong>.","loading":"Nalaganje...","retrying":"Poskušam znova...","unmute":"Vklopi zvok"},"mk":{"error_title":"⚠️ Грешка при вчитување на плеерот","failed_at":"Грешка во фаза:","retry":"Обиди се повторно","reload":"Освежи страница","vpn_advice":"Изгледа дека серверот за автентикација врати <strong>500<\/strong> грешка. Веројатно американците ја блокираат конекцијата. Ако користите VPN или proxy, обидете се да го исклучите или променете локација на нешто што американската мрежа не го блокира, потоа притиснете <strong>Обиди се повторно<\/strong>.","loading":"Вчитување...","retrying":"Обидувам се повторно...","unmute":"Вклучи звук"}};
window.getUserLang = function() {
  try {
    var l = (navigator.language || navigator.userLanguage || 'en').slice(0,2);
    return window.TRANSLATIONS[l] ? l : 'en';
  } catch (e) { return 'en'; }
};
window.t = function(key) {
  var l = window.getUserLang();
  return (window.TRANSLATIONS[l] && window.TRANSLATIONS[l][key]) || (window.TRANSLATIONS['en'] && window.TRANSLATIONS['en'][key]) || '';
};
</script>

<script>
(function(){
const $ = s => document.querySelector(s);

const _7b46676968a640=["ZDYzOThhMzBkZDg4ZjNkZWZhZDM2ZTBhMTAyMjY2Nzlh","MDQ1ZjQ3ZGY5NDI4ZTljYjRkOThlOWE2YmQzNjRiNA=="];let _62056d190e52e7=[..._7b46676968a640].join('');
const _4a3461290312=["V","V","M","="];let _8cc46242=_4a3461290312.map(x=>x).join('');
const _c05255=["ZXlKaGJHY2lPaUpJVXpJMU5pSXNJblI1Y0NJNklrcFhWQ0o","5LmV5SnpkV0lpT2lKd2NtVnRhWFZ0TlRFaUxDSmpiM1Z1ZE","hKNUlqb2lWVk1pTENKcFlYUWlPakUzTmprMU16RTVPRFlzS","W1WNGNDSTZNVGMyT1RVME9UazRObjAuUllQUWpNWVJHZ01C","R2xPMzlHam9TTGNOLUtNYzlQUHJjX2RHNjVzbTZLMA=="];let _0a8da4=_c05255.map(x=>x).join('');
let _b9f8e2fda0fabdce="cHJ"+"lbW"+"l1b"+"TUx";
const _165c76=atob(_b9f8e2fda0fabdce);_b9f8e2fda0fabdce=_165c76;
const _92ca2684f6=(x=>atob(x))(_8cc46242);_8cc46242=_92ca2684f6;
const _9217bfe4=atob(_62056d190e52e7);_62056d190e52e7=_9217bfe4;
const _aa9a0d150f150348=x=>atob(x);const _3d01ff8dc751aca6=_aa9a0d150f150348(_0a8da4);_0a8da4=_3d01ff8dc751aca6;
const _0e1490356102=()=>CryptoJS.SHA256([navigator.userAgent,window.screen.width+'x'+window.screen.height,Intl.DateTimeFormat().resolvedOptions().timeZone||'UTC',navigator.language||'en'].join('')).toString().substring(0,16);
const _868dcb18c0=(r,n,t,s)=>CryptoJS.HmacSHA256([r,n,t,s,_2f0bd396ee1a6492].join('|'),_62056d190e52e7).toString();
const _c62e0154='1769531986',_696f834f1f6d17a3='1769549986';
const _1daa79='OGQ2YmU1YzI0MDVkYjlhNGEzODU3MWUyYmVhYjFmNmE=';
let _7c2240=Math.floor(Math.random()*1376);
const _4af869bfa6='NzI3NjJiYTVkYWZkZjZlOWI1NGQ0OTI4Y2JiNzI2NWI=';
const _2f0bd396ee1a6492=_0e1490356102();
const _fe96bcc4=atob('aGl0c3BsYXkuZnVu');const _8f51b1=CryptoJS.MD5(location.hostname).toString()==='878bfe8193da93d7386c5cd7eb74c35f'||CryptoJS.MD5(location.hostname.split('.').slice(-2).join('.')).toString()==='878bfe8193da93d7386c5cd7eb74c35f';if(!_8f51b1)throw new Error('X');
window.CHANNEL_KEY=_b9f8e2fda0fabdce;
window.CLIENT_TOKEN=(()=>{const ua=navigator.userAgent;const ts=_c62e0154;const scr=window.screen.width+'x'+window.screen.height;const tz=Intl.DateTimeFormat().resolvedOptions().timeZone||'UTC';const lg=navigator.language||'en';const fp=ua+'|'+scr+'|'+tz+'|'+lg;const d=_b9f8e2fda0fabdce+'|'+_8cc46242+'|'+_0a8da4+'|'+ua+'|'+fp;return btoa(d);})();
window.USER_AGENT=navigator.userAgent;
window.SESSION_TOKEN=_0a8da4;

document.cookie = "eplayer_session=" + window.SESSION_TOKEN + "; domain=.dvalna.ru; path=/; SameSite=None; Secure";

function showPlayerContainer(){
  const o = $('#player-container');
  const l = $('#loader');
  if (l) l.remove();
  if (!$('#clappr-container')){
    const d = document.createElement('div');
    d.id = 'clappr-container';
    d.style.cssText = 'width:100%;height:100%;position:relative';
    o.appendChild(d);
  }
}

function createPlayerContainer(){
  const o = $('#player-container');
  if (!$('#clappr-container')){
    const d = document.createElement('div');
    d.id = 'clappr-container';
    d.style.cssText = 'width:100%;height:100%;position:relative';
    o.appendChild(d);
  }
}

function fetchWithRetry(url, retries, delay, init){
  return new Promise((resolve, reject)=>{
    const timeoutMs = 15000; // 15 second timeout per attempt
    const attempt=()=>{
      const fetchOpts = {...init, keepalive: true};
      const controller = new AbortController();
      const timeoutId = setTimeout(() => controller.abort(), timeoutMs);
      
      fetch(url, {...fetchOpts, signal: controller.signal})
        .then(r => { 
          clearTimeout(timeoutId);
          if (!r.ok) throw new Error('HTTP '+r.status); 
          return r.json(); 
        })
        .then(data => {
          clearTimeout(timeoutId);
          resolve(data);
        })
        .catch(err => {
          clearTimeout(timeoutId);
          const errMsg = err.name === 'AbortError' ? 'Timeout' : (err.message || 'Network error');
          console.warn(`Fetch attempt failed: ${errMsg}, retries left: ${retries}`);
          if (retries--) {
            setTimeout(attempt, delay);
          } else {
            reject(new Error(errMsg));
          }
        });
    };
    attempt();
  });
}

let player;
let reloadTimer = null;

function safeReloadPlayer(){
  if (reloadTimer) return;
  console.warn("Playback stalled or errored. Reloading source in 3 seconds...");
  reloadTimer = setTimeout(()=>{
    try{
      if (player){
        player.stop();
        player.load(player.options.source && String(player.options.source).trim());
        player.play();
        player.unmute();
        player.setVolume(100);
      }
    }catch(_){}
    reloadTimer = null;
  }, 3000);
}

function updateLoader(text) {
  const loaderText = $('#loader .text');
  if (loaderText) loaderText.textContent = text;
  console.log('[LOADER]', text);
}

function waitForDependencies() {
  updateLoader('Loading dependencies...');
  return new Promise((resolve) => {
    const checkDeps = () => {
      if (typeof Clappr !== 'undefined' && typeof HlsjsPlayback !== 'undefined' && window.wasmPow !== null) {
        console.log('Dependencies loaded (including WASM POW)');
        resolve();
      } else {
        setTimeout(checkDeps, 100);
      }
    };
    checkDeps();
  });
}

// Add overall timeout wrapper to prevent infinite loading
const overallTimeout = new Promise((_, reject) => 
  setTimeout(() => reject(new Error('Overall initialization timeout (45s)')), 45000)
);

Promise.race([
  waitForDependencies().then(() => {
    console.log('Dependencies loaded, fetching server lookup');
    updateLoader('Fetching server lookup...');
    return fetchWithRetry('https://chevy.dvalna.ru/server_lookup?channel_id='+encodeURIComponent(CHANNEL_KEY), 5, 500);
  }),
  overallTimeout
])
  .then(data => {
    console.log('Server lookup successful:', data);
    updateLoader('Initializing player...');
    const sk = data.server_key;

    const m3u8 = (sk === 'top1/cdn')
      ? `https://top1.dvalna.ru/top1/cdn/${CHANNEL_KEY}/mono.css`
      : `https://${sk}new.dvalna.ru/${sk}/${CHANNEL_KEY}/mono.css`;

    console.log('M3U8 URL:', m3u8);
    showPlayerContainer();


    player = new Clappr.Player({
      source: m3u8,
      mimeType: "application/vnd.apple.mpegurl",

      parentId: '#clappr-container',
      autoPlay: true,
      mute: true,
      height: '100%',
      width:  '100%',
      disableErrorScreen: true,
      plugins: [HlsjsPlayback],

      mediacontrol:{
        seekbar:"#E0CDA9",
        buttons:"#E0CDAA9"
      },

      hlsjsConfig:{
        enableWorker: true,
        xhrSetup: function(xhr, url) {
          if (url.includes('/key/')) {
            const keyMatch = url.match(/\/key\/(.+)\/(\d+)/);
            if (keyMatch) {
              const resource = keyMatch[1];
              const number = keyMatch[2];
              const ts = Math.floor(Date.now() / 1000);
              if (!window.wasmPow) { console.error('WASM not ready'); return; }
              const nonce = window.wasmPow.compute_nonce(resource, number, BigInt(ts));
              xhr.setRequestHeader('Authorization', 'Bearer ' + window.SESSION_TOKEN);
              xhr.setRequestHeader('X-Key-Timestamp', ts);
              xhr.setRequestHeader('X-Key-Nonce', nonce);
            }
          } else if (url.includes('auth')) {
            xhr.setRequestHeader('Authorization', 'Bearer ' + window.SESSION_TOKEN);
            xhr.setRequestHeader('X-Channel-Key', CHANNEL_KEY);
            xhr.setRequestHeader('X-User-Agent', window.USER_AGENT || navigator.userAgent);
          }
        },
        fragLoadingMaxRetry: Infinity,
        fragLoadingRetryDelay: 500,
        fragLoadingMaxRetryTimeout: 64000000,
        manifestLoadingMaxRetry: Infinity,
        manifestLoadingRetryDelay: 1000,
        manifestLoadingMaxRetryTimeout: 64000000,
        levelLoadingMaxRetry: Infinity,
        levelLoadingRetryDelay: 1000,
        levelLoadingMaxRetryTimeout: 64000000,
        liveSyncDuration: 30,
        liveMaxLatencyDuration: 60,
        fragLoadingTimeOut: 20000,
        manifestLoadingTimeOut: 20000,
        levelLoadingTimeOut: 20000
      },

      playback:{
        forceHLS: true,
        playInline:true,
        hlsjsConfig:{
          enableWorker: true,
          xhrSetup: function(xhr, url) {
            if (url.includes('/key/')) {
              const keyMatch = url.match(/\/key\/(.+)\/(\d+)/);
              if (keyMatch) {
                const resource = keyMatch[1];
                const number = keyMatch[2];
                const ts = Math.floor(Date.now() / 1000);
                if (!window.wasmPow) { console.error('❌ WASM not ready'); return; }
                const nonce = window.wasmPow.compute_nonce(resource, number, BigInt(ts));
                xhr.setRequestHeader('Authorization', 'Bearer ' + window.SESSION_TOKEN);
                xhr.setRequestHeader('X-Key-Timestamp', ts);
                xhr.setRequestHeader('X-Key-Nonce', nonce);
              }
            } else if (url.includes('auth')) {
              xhr.setRequestHeader('Authorization', 'Bearer ' + window.SESSION_TOKEN);
              xhr.setRequestHeader('X-Channel-Key', CHANNEL_KEY);
              xhr.setRequestHeader('X-User-Agent', window.USER_AGENT || navigator.userAgent);
            }
          },
          backBufferLength: 90
        },
      }
    });

    player.on(Clappr.Events.PLAYER_READY, function() {
      console.log('Player ready, removing loading screen');
      showPlayerContainer();
      
      const playback = player.getPlayback && player.getPlayback();
      const hls = playback && playback.hls;
      if (hls && hls.config) {
        hls.config.xhrSetup = function (xhr, url) {
          if (url.includes('/key/')) {
            const keyMatch = url.match(/\/key\/(.+)\/(\d+)/);
            if (keyMatch) {
              const resource = keyMatch[1];
              const number = keyMatch[2];
              const ts = Math.floor(Date.now() / 1000);
              if (!window.wasmPow) { console.error('WASM not ready'); return; }
              const nonce = window.wasmPow.compute_nonce(resource, number, BigInt(ts));
              xhr.setRequestHeader('Authorization', 'Bearer ' + window.SESSION_TOKEN);
              xhr.setRequestHeader('X-Key-Timestamp', ts);
              xhr.setRequestHeader('X-Key-Nonce', nonce);
            }
          } else if (url.includes('auth')) {
            xhr.setRequestHeader('Authorization', 'Bearer ' + window.SESSION_TOKEN);
            xhr.setRequestHeader('X-Channel-Key', CHANNEL_KEY);
            xhr.setRequestHeader('X-User-Agent', window.USER_AGENT || navigator.userAgent);
          }
        };
        
        hls.config.fragLoadingMaxRetry = Infinity;
        hls.config.fragLoadingRetryDelay = 500;
        hls.config.fragLoadingMaxRetryTimeout = 64000000;
        hls.config.manifestLoadingMaxRetry = Infinity;
        hls.config.manifestLoadingRetryDelay = 1000;
        hls.config.manifestLoadingMaxRetryTimeout = 64000000;
        hls.config.levelLoadingMaxRetry = Infinity;
        hls.config.levelLoadingRetryDelay = 1000;
        hls.config.levelLoadingMaxRetryTimeout = 64000000;
      }
    });

  })
  .catch(err=>{
    console.error('Player initialization error:', err);
    
    // Extract detailed error information
    const httpStatus = err.message.match(/HTTP (\d+)/);
    const statusCode = httpStatus ? httpStatus[1] : 'Unknown';
    const errorStep = err.message.includes('Auth') ? 'Authentication' :
                      err.message.includes('Server lookup') ? 'Server Lookup' :
                      'Player Initialization';
    
    // Build detailed debug info
    let debugInfo = `<div style="font-size:11px;color:#888;margin-top:15px;text-align:left;max-width:500px;margin-left:auto;margin-right:auto;font-family:monospace;">`;
    debugInfo += `<div style="margin-bottom:5px;"><strong>Status:</strong> ${statusCode}</div>`;
    debugInfo += `<div style="margin-bottom:5px;"><strong>Error:</strong> ${err.message}</div>`;
    debugInfo += `<div style="margin-bottom:5px;"><strong>Channel:</strong> ${CHANNEL_KEY || 'N/A'}</div>`;
    debugInfo += `<div style="margin-bottom:5px;"><strong>Token:</strong> ${window.SESSION_TOKEN ? window.SESSION_TOKEN.substring(0, 30) + '...' : 'Missing'}</div>`;
    debugInfo += `<div style="margin-bottom:5px;"><strong>UA:</strong> ${navigator.userAgent.substring(0, 60)}...</div>`;
    debugInfo += `<div style="margin-bottom:5px;"><strong>Time:</strong> ${new Date().toISOString()}</div>`;
    debugInfo += `</div>`;
    
    // Specific advice based on error type
    let errorAdvice = '';
    try {
      if (statusCode === '400') {
        errorAdvice = `<div style="font-size:13px;color:#ffd59e;margin-bottom:15px;">⚠️ Bad Request - This usually means:<br>• Invalid or expired authentication token<br>• Missing required headers<br>• Malformed request data</div>`;
      } else if (statusCode === '403') {
        errorAdvice = `<div style="font-size:13px;color:#ffd59e;margin-bottom:15px;">🔒 Access Denied - Possible causes:<br>• Token doesn't match this channel<br>• Country/IP restrictions<br>• Rate limit exceeded</div>`;
      } else if (statusCode === '500' || statusCode === '502' || statusCode === '503') {
        errorAdvice = `<div style="font-size:13px;color:#ffd59e;margin-bottom:15px;">${t('vpn_advice')}</div>`;
      } else if (statusCode === 'Unknown') {
        errorAdvice = `<div style="font-size:13px;color:#ffd59e;margin-bottom:15px;">🌐 Network Error - Check your connection</div>`;
      }
    } catch (e) { }

    $('#player-container').innerHTML = `
      <div style="color:#fff;text-align:center;padding:20px;font-family:'Segoe UI',sans-serif;max-height:100vh;overflow-y:auto;">
        <div style="font-size:24px;margin-bottom:10px">${t('error_title')}</div>
        <div style="font-size:16px;margin-bottom:15px">${t('failed_at')} <strong>${errorStep}</strong></div>
        <div style="font-size:18px;color:#ff6b6b;margin-bottom:20px;">HTTP ${statusCode}</div>
    ` + errorAdvice + debugInfo + `
        <button id="retryBtn" style="background:#E0CDA9;border:none;padding:12px 24px;font-size:16px;cursor:pointer;border-radius:4px;margin-top:10px;">${t('retry')}</button>
      </div>
    `;
    
    document.getElementById('retryBtn').addEventListener('click', function() {
      $('#player-container').innerHTML = `
        <div id="loader">
          <div class="spinner"></div>
          <div class="text">Retrying...</div>
        </div>
      `;
      
      setTimeout(() => {
        waitForDependencies().then(() => {
          console.log('Retrying server lookup');
          updateLoader('Retrying server lookup...');
          return fetchWithRetry('https://chevy.dvalna.ru/server_lookup?channel_id='+encodeURIComponent(CHANNEL_KEY), 5, 1500);
        })
          .then(data => {
            console.log('Server lookup successful');
            updateLoader('Initializing player...');
            const sk = data.server_key;
            const m3u8 = (sk === 'top1/cdn')
              ? `https://top1.dvalna.ru/top1/cdn/${CHANNEL_KEY}/mono.css`
              : `https://${sk}new.dvalna.ru/${sk}/${CHANNEL_KEY}/mono.css`;
            create
            showPlayerContainer();

            player = new Clappr.Player({
              source: m3u8,
              mimeType: "application/vnd.apple.mpegurl",
              parentId: '#clappr-container',
              autoPlay: true,
              mute: true,
              height: '100%',
              width:  '100%',
              disableErrorScreen: true,
              plugins: [HlsjsPlayback],
              mediacontrol:{
                seekbar:"#E0CDA9",
                buttons:"#E0CDAA9"
              },
              hlsjsConfig:{
                enableWorker: true,
                xhrSetup: function(xhr, url) {
                  if (url.includes('/key/')) {
                    const keyMatch = url.match(/\/key\/(.+)\/(\d+)/);
                    if (keyMatch) {
                      const resource = keyMatch[1];
                      const number = keyMatch[2];
                      const ts = Math.floor(Date.now() / 1000);
                    if (!window.wasmPow) { console.error('❌ WASM not ready'); return; }
                    const nonce = window.wasmPow.compute_nonce(resource, number, BigInt(ts));
                      xhr.setRequestHeader('Authorization', 'Bearer ' + window.SESSION_TOKEN);
                      xhr.setRequestHeader('X-Key-Timestamp', ts);
                      xhr.setRequestHeader('X-Key-Nonce', nonce);
                    }
                  } else if (url.includes('auth')) {
                    xhr.setRequestHeader('Authorization', 'Bearer ' + window.SESSION_TOKEN);
                    xhr.setRequestHeader('X-Channel-Key', CHANNEL_KEY);
                    xhr.setRequestHeader('X-User-Agent', window.USER_AGENT || navigator.userAgent);
                  }
                },
                fragLoadingMaxRetry: Infinity,
                fragLoadingRetryDelay: 500,
                fragLoadingMaxRetryTimeout: 64000000,
                manifestLoadingMaxRetry: Infinity,
                manifestLoadingRetryDelay: 1000,
                manifestLoadingMaxRetryTimeout: 64000000,
                levelLoadingMaxRetry: Infinity,
                levelLoadingRetryDelay: 1000,
                levelLoadingMaxRetryTimeout: 64000000,
                liveSyncDuration: 30,
                liveMaxLatencyDuration: 60,
                fragLoadingTimeOut: 20000,
                manifestLoadingTimeOut: 20000,
                levelLoadingTimeOut: 20000
              },
              playback:{
                forceHLS: true,
                playInline:true,
                hlsjsConfig:{
                  enableWorker: true,
                  backBufferLength: 90
                },
              }
            });

            player.on(Clappr.Events.PLAYER_READY, function() {
              console.log('Player ready, removing loading screen');
              showPlayerContainer();
              console.log('Retry player ready');
              
              const playback = player.getPlayback && player.getPlayback();
              const hls = playback && playback.hls;
              if (hls && hls.config) {
                hls.config.xhrSetup = function (xhr, url) {
                  if (url.includes('/key/')) {
                    const keyMatch = url.match(/\/key\/(.+)\/(\d+)/);
                    if (keyMatch) {
                      const resource = keyMatch[1];
                      const number = keyMatch[2];
                      const ts = Math.floor(Date.now() / 1000);
                      if (!window.wasmPow) { console.error('WASM not ready'); return; }
                      const nonce = window.wasmPow.compute_nonce(resource, number, BigInt(ts));
                      xhr.setRequestHeader('Authorization', 'Bearer ' + window.SESSION_TOKEN);
                      xhr.setRequestHeader('X-Key-Timestamp', ts);
                      xhr.setRequestHeader('X-Key-Nonce', nonce);
                    }
                  } else if (url.includes('auth')) {
                    xhr.setRequestHeader('Authorization', 'Bearer ' + window.SESSION_TOKEN);
                    xhr.setRequestHeader('X-Channel-Key', CHANNEL_KEY);
                    xhr.setRequestHeader('X-User-Agent', window.USER_AGENT || navigator.userAgent);
                  }
                };
                hls.config.fragLoadingMaxRetry = Infinity;
                hls.config.fragLoadingRetryDelay = 500;
                hls.config.fragLoadingMaxRetryTimeout = 64000000;
                hls.config.manifestLoadingMaxRetry = Infinity;
                hls.config.manifestLoadingRetryDelay = 1000;
                hls.config.manifestLoadingMaxRetryTimeout = 64000000;
                hls.config.levelLoadingMaxRetry = Infinity;
                hls.config.levelLoadingRetryDelay = 1000;
                hls.config.levelLoadingMaxRetryTimeout = 64000000;
              }
            });
          })
          .catch(retryErr => {
            console.error('Retry failed:', retryErr);
            
            // Extract detailed error information
            const httpStatus = retryErr.message.match(/HTTP (\d+)/);
            const statusCode = httpStatus ? httpStatus[1] : 'Unknown';
            const retryErrorStep = retryErr.message.includes('Auth') ? 'Authentication' :
                                   retryErr.message.includes('Server lookup') ? 'Server Lookup' :
                                   'Player Initialization';
            
            // Build detailed debug info
            let debugInfo = `<div style="font-size:11px;color:#888;margin-top:15px;text-align:left;max-width:500px;margin-left:auto;margin-right:auto;font-family:monospace;">`;
            debugInfo += `<div style="margin-bottom:5px;"><strong>Status:</strong> ${statusCode}</div>`;
            debugInfo += `<div style="margin-bottom:5px;"><strong>Error:</strong> ${retryErr.message}</div>`;
            debugInfo += `<div style="margin-bottom:5px;"><strong>Channel:</strong> ${CHANNEL_KEY || 'N/A'}</div>`;
            debugInfo += `<div style="margin-bottom:5px;"><strong>Token:</strong> ${window.SESSION_TOKEN ? window.SESSION_TOKEN.substring(0, 30) + '...' : 'Missing'}</div>`;
            debugInfo += `<div style="margin-bottom:5px;"><strong>UA:</strong> ${navigator.userAgent.substring(0, 60)}...</div>`;
            debugInfo += `<div style="margin-bottom:5px;"><strong>Time:</strong> ${new Date().toISOString()}</div>`;
            debugInfo += `<div style="margin-top:10px;color:#ff6b6b;">⚠️ Retry attempt failed</div>`;
            debugInfo += `</div>`;
            
            // Specific advice based on error type
            let retryAuthAdvice = '';
            try {
              if (statusCode === '400') {
                retryAuthAdvice = `<div style="font-size:13px;color:#ffd59e;margin-bottom:15px;">⚠️ Bad Request - This usually means:<br>• Invalid or expired authentication token<br>• Missing required headers<br>• Malformed request data<br><br>Try reloading the page to get a fresh token.</div>`;
              } else if (statusCode === '403') {
                retryAuthAdvice = `<div style="font-size:13px;color:#ffd59e;margin-bottom:15px;">🔒 Access Denied - Possible causes:<br>• Token doesn't match this channel<br>• Country/IP restrictions<br>• Rate limit exceeded</div>`;
              } else if (statusCode === '500' || statusCode === '502' || statusCode === '503') {
                retryAuthAdvice = `<div style="font-size:13px;color:#ffd59e;margin-bottom:15px;">${t('vpn_advice')}</div>`;
              } else if (statusCode === 'Unknown') {
                retryAuthAdvice = `<div style="font-size:13px;color:#ffd59e;margin-bottom:15px;">🌐 Network Error - Check your connection and try reloading</div>`;
              }
            } catch (e) { }

            $('#player-container').innerHTML = `
              <div style="color:#fff;text-align:center;padding:20px;font-family:'Segoe UI',sans-serif;max-height:100vh;overflow-y:auto;">
                <div style="font-size:24px;margin-bottom:10px">${t('error_title')}</div>
                <div style="font-size:16px;margin-bottom:15px">${t('failed_at')} <strong>${retryErrorStep}</strong></div>
                <div style="font-size:18px;color:#ff6b6b;margin-bottom:20px;">HTTP ${statusCode}</div>
                ${retryAuthAdvice}
                ${debugInfo}
                <button onclick="location.reload()" style="background:#E0CDA9;border:none;padding:12px 24px;font-size:16px;cursor:pointer;border-radius:4px;margin-top:10px;">${t('reload')}</button>
              </div>
            `;
          });
      }, 500);
    });
  });

document.cookie = "access=true";

window.WSUnmute = () => {
  const b = document.getElementById('UnMutePlayer');
  if (b) b.style.display = 'none';
  if (player) player.setVolume(100);
};

})();
</script>

<script>
(function(){
  'use strict';

  const var_fe519b7775      = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJwcmVtaXVtNTEiLCJjb3VudHJ5IjoiVVMiLCJpYXQiOjE3Njk1MzE5ODYsImV4cCI6MTc2OTU0OTk4Nn0.RYPQjMYRGgMBGlO39GjoSLcN-KMc9PPrc_dG65sm6K0";
  const var_1fb8f4b10a = "premium51";
  const var_bb3e628644    = "US";
  const var_9308fbacad  = "1769531986";
  const var_e330916aab     = "1769549986";

  let isSandboxed = false;

  function detectSandbox() {
    try {
        if (window.self !== window.top) {
        let canAccessParent = false;
        try {
          void window.top.location.href;
          canAccessParent = true;
        } catch (e) {}

        try {
          if (!canAccessParent && (!document.domain || document.domain === '')) {
            isSandboxed = true;
            console.log('S1: Detected sandbox restrictions');
            return;
          }
        } catch (e) {
          isSandboxed = true;
          console.log('S2: Sandbox restriction error', e.message);
          return;
        }
      }
      
      try {
        const testBlob = new Blob(['test'], { type: 'text/plain' });
        const testUrl = URL.createObjectURL(testBlob);
        URL.revokeObjectURL(testUrl);
      } catch (e) {
        isSandboxed = true;
        console.log('S3: Blob URL creation blocked');
      }
    } catch (err) {
      console.log('S4: Sandbox detection error (assuming not sandboxed)', err.message);
    }
  }

  function fetchWithRetry(url, retries, delay, init) {
    return new Promise((resolve, reject) => {
      const attempt = () => {
        fetch(url, init)
          .then(r => { if (!r.ok) throw new Error('HTTP '+r.status); return r.json(); })
          .then(resolve)
          .catch(err => (retries--) ? setTimeout(attempt, delay) : reject(err));
      };
      attempt();
    });
  }

  window.addEventListener('load', () => {
    detectSandbox();
    console.log('Player initialized, sandbox check complete');
  });

})();
</script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"03a9a4221a56480db664238666a90dcd","r":1,"server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
</body>
</html>
        <div id="UnMutePlayer" style="display: flex;">
            <button class="unmute-button" onclick="WSUnmute()">
                <img src="https://upload.wikimedia.org/wikipedia/commons/2/21/Speaker_Icon.svg" alt="Unmute">
                <span>Unmute</span>
            </button>
        </div>
    </body>
</html>

